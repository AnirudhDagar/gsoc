<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.0.0">Jekyll</generator><link href="https://anirudhdagar.github.io/gsoc/feed.xml" rel="self" type="application/atom+xml" /><link href="https://anirudhdagar.github.io/gsoc/" rel="alternate" type="text/html" /><updated>2021-05-02T14:27:51-05:00</updated><id>https://anirudhdagar.github.io/gsoc/feed.xml</id><title type="html">GSoC</title><subtitle>Anirudh Dagar's GSoC Blog @ CERN-HSF</subtitle><entry><title type="html">End of GSoC!</title><link href="https://anirudhdagar.github.io/gsoc/evaluation/gsoc/experience/2020/08/31/GSoC-End.html" rel="alternate" type="text/html" title="End of GSoC!" /><published>2020-08-31T00:00:00-05:00</published><updated>2020-08-31T00:00:00-05:00</updated><id>https://anirudhdagar.github.io/gsoc/evaluation/gsoc/experience/2020/08/31/GSoC-End</id><content type="html" xml:base="https://anirudhdagar.github.io/gsoc/evaluation/gsoc/experience/2020/08/31/GSoC-End.html">&lt;blockquote&gt;
  &lt;p&gt;TLDR: It feels unbelievable to have contributed to CERN as a GSoC student. My contributions can be found at &lt;a href=&quot;https://github.com/root-project/root/pull/5757&quot;&gt;#5757&lt;/a&gt; and &lt;a href=&quot;https://github.com/root-project/root/pull/6273&quot;&gt;#6273&lt;/a&gt;.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img alt=&quot;Can't See? Something went wrong!&quot; src=&quot;/gsoc/images/gsoc_final_remarks.jpg&quot; width=&quot;60%&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;journey&quot;&gt;Journey&lt;/h1&gt;

&lt;p&gt;Summer of 2020 has been nothing short of a roller-coaster ride filled with challenges and obstacles. I feel a sense of achievement looking back at the work I managed to complete while hitting my goals and targets in these trying times. Ever since my first pull request got merged, I have been longing to create an impact with open-source contributions. Thanks to CERN-HSF and Google Summer Of Code for providing me an opportunity to work on the &lt;strong&gt;ROOT TMVA&lt;/strong&gt; framework which provides a machine learning environment for the modelling, processing, and evaluation of high-energy physics data.&lt;/p&gt;

&lt;p&gt;Let me take you through the work I‚Äôve carried out this summer.&lt;/p&gt;

&lt;p&gt;During these three months, I developed a PyTorch Interface for TMVA. Hopefully, users and developers will utilize the newest addition to the TMVA family.&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;pull-requests&quot;&gt;Pull Requests&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;[Major]&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://github.com/root-project/root/pull/5757&quot;&gt;#5757&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://github.com/root-project/root/pull/6273&quot;&gt;#6273&lt;/a&gt; (Later moved to &lt;a href=&quot;https://github.com/root-project/root/pull/6935&quot;&gt;#6935&lt;/a&gt;)&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;[Minor]&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://github.com/root-project/root/pull/5936&quot;&gt;#5936&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://github.com/root-project/root/pull/6253&quot;&gt;#6253&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;deliverables-achieved&quot;&gt;Deliverables Achieved&lt;/h2&gt;

&lt;h3 id=&quot;source&quot;&gt;Source&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;Header MethodPyTorch&lt;/strong&gt;&lt;/p&gt;

&lt;ul class=&quot;task-list&quot;&gt;
  &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Implementation of &lt;code class=&quot;highlighter-rouge&quot;&gt;MethodPyTorch.h&lt;/code&gt; header.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;Class MethodPyTorch&lt;/strong&gt;&lt;/p&gt;

&lt;ul class=&quot;task-list&quot;&gt;
  &lt;li class=&quot;task-list-item&quot;&gt;
    &lt;p&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Implementation of &lt;code class=&quot;highlighter-rouge&quot;&gt;MethodPyTorch.cxx&lt;/code&gt; class.&lt;/p&gt;

    &lt;ul class=&quot;task-list&quot;&gt;
      &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Implement the &lt;code class=&quot;highlighter-rouge&quot;&gt;DeclareOptions&lt;/code&gt; method&lt;/li&gt;
      &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Implement &lt;code class=&quot;highlighter-rouge&quot;&gt;ProcessOptions&lt;/code&gt; methods&lt;/li&gt;
      &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Implement &lt;code class=&quot;highlighter-rouge&quot;&gt;SetupTorchModel&lt;/code&gt; method&lt;/li&gt;
      &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Implement train methods
        &lt;ul class=&quot;task-list&quot;&gt;
          &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Implement simple basic structure for training&lt;/li&gt;
          &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Add ability to load code from users&lt;/li&gt;
          &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Convert numpy based dataloaders in TMVA to PyTorch dataloaders&lt;/li&gt;
          &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Use default (optional optimizer SGD)&lt;/li&gt;
          &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Add callbacks: savebest model, scheduler etc&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Implement &lt;code class=&quot;highlighter-rouge&quot;&gt;GetNumValidationSamples&lt;/code&gt;&lt;/li&gt;
      &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Implement Validation in &lt;code class=&quot;highlighter-rouge&quot;&gt;train_func&lt;/code&gt;&lt;/li&gt;
      &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Add model prediction function loading ability&lt;/li&gt;
      &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Implementation of the &lt;code class=&quot;highlighter-rouge&quot;&gt;GetMVA*&lt;/code&gt;
        &lt;ul class=&quot;task-list&quot;&gt;
          &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;GetMvaValues&lt;/code&gt; method for Classification&lt;/li&gt;
          &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;GetRegressionValues&lt;/code&gt; method for Regression&lt;/li&gt;
          &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;GetMulticlassValues&lt;/code&gt; method for MultiClass Classification.&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Implement helper function&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;tests&quot;&gt;Tests&lt;/h3&gt;
&lt;ul class=&quot;task-list&quot;&gt;
  &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Add testPyTorchClassification.C
    &lt;ul class=&quot;task-list&quot;&gt;
      &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Add generatePyTorchModelClassification.py&lt;/li&gt;
      &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Load, Train model and test all the parameter arguments&lt;/li&gt;
      &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Verify response after model prediction function is added.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Add testPyTorchMulticlass.C
    &lt;ul class=&quot;task-list&quot;&gt;
      &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Add generatePyTorchModelMulticlass.py&lt;/li&gt;
      &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Load, Train model and test all the parameter arguments&lt;/li&gt;
      &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Verify response after model prediction function is added.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Add testPyTorchRegression.C
    &lt;ul class=&quot;task-list&quot;&gt;
      &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Add generatePyTorchModelRegression.py&lt;/li&gt;
      &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Load, Train model and test all the parameter arguments&lt;/li&gt;
      &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Verify response after model prediction function is added.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;tutorials&quot;&gt;Tutorials&lt;/h3&gt;

&lt;p&gt;Made a blog post &lt;a href=&quot;https://anirudhdagar.github.io/gsoc/tmva/pytorch/root/2020/08/21/TMVA-PyTorch-Tutorial.html&quot;&gt;here&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Also the tutorials are implemented in &lt;a href=&quot;https://github.com/root-project/root/pull/6273&quot;&gt;#6273&lt;/a&gt;&lt;/p&gt;

&lt;ul class=&quot;task-list&quot;&gt;
  &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Add TMVA ClassificationPyTorch&lt;/li&gt;
  &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Add TMVA RegressionPyTorch&lt;/li&gt;
  &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Add TMVA MulticlassPyTorch&lt;/li&gt;
  &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Add TMVA ApplicationRegressionPyTorch&lt;/li&gt;
  &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Add TMVA ApplicationClassificationPyTorch&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;acknowledgements&quot;&gt;Acknowledgements&lt;/h2&gt;

&lt;p&gt;I am grateful to my mentors for their invaluable guidance and support throughout my GSoC journey. ‚ù§Ô∏è&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://www.linkedin.com/in/lorenzo-moneta-982b902/&quot;&gt;Lorenzo Moneta&lt;/a&gt; (Senior Physicist at CERN)&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://www.linkedin.com/in/omar-andres-zapata-mesa-4ab16a5b/&quot;&gt;Omar Andres Zapata Mesa&lt;/a&gt; (Research Fellow at CERN)&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Thank you for believing in me. I honestly never thought I would have the chance to get in, or even be accepted, at one of the finest research organizations in the world. Hoping that my contributions may help in the next Major Physics discovery at CERN! üí•&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;
Signing Off,&lt;/p&gt;

&lt;p&gt;Anirudh Dagar&lt;/p&gt;</content><author><name></name></author><summary type="html">TLDR: It feels unbelievable to have contributed to CERN as a GSoC student. My contributions can be found at #5757 and #6273.</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://anirudhdagar.github.io/gsoc/images/gsoc_final_remarks.jpg" /><media:content medium="image" url="https://anirudhdagar.github.io/gsoc/images/gsoc_final_remarks.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Tutorial: TMVA PyTorch Interface</title><link href="https://anirudhdagar.github.io/gsoc/tmva/pytorch/root/2020/08/21/TMVA-PyTorch-Tutorial.html" rel="alternate" type="text/html" title="Tutorial: TMVA PyTorch Interface" /><published>2020-08-21T00:00:00-05:00</published><updated>2020-08-21T00:00:00-05:00</updated><id>https://anirudhdagar.github.io/gsoc/tmva/pytorch/root/2020/08/21/TMVA-PyTorch-Tutorial</id><content type="html" xml:base="https://anirudhdagar.github.io/gsoc/tmva/pytorch/root/2020/08/21/TMVA-PyTorch-Tutorial.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-08-21-TMVA-PyTorch-Tutorial.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Introduction&quot;&gt;Introduction&lt;a class=&quot;anchor-link&quot; href=&quot;#Introduction&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;This tutorial aims to walkthrough the latest addition in the &lt;a href=&quot;https://github.com/root-project/root&quot;&gt;ROOT TMVA&lt;/a&gt; module, &lt;strong&gt;The PyTorch Interface!&lt;/strong&gt; This is specifically designed to utilize the puissance of &lt;a href=&quot;http://root.cern.ch/&quot;&gt;ROOT&lt;/a&gt; for working with high energy physics data, while leveraging the power and flexibility of the popular Machine Learning framework, PyTorch.&lt;/p&gt;
&lt;p&gt;The PyTorch interface allows HEP Scientists to be more ingenious with ideas and provides the ability to customize Machine Learning models to a far more preponderant extent than the Keras Interface.&lt;/p&gt;
&lt;p&gt;Here, we'll build a simple classifier in python using PyTorch and compare the performance to a few other methods on a test example root dataset. The same model can be achieved in C/C++ like other TMVA methods which are implemented in C/C++. You can follow &lt;a href=&quot;https://github.com/root-project/root/tree/master/tmva/pymva/test/testPyTorchClassification.C&quot;&gt;this&lt;/a&gt; if you prefer a C++ implementation.&lt;/p&gt;
&lt;h3 id=&quot;Imports&quot;&gt;Imports&lt;a class=&quot;anchor-link&quot; href=&quot;#Imports&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;We start with importing the necessary modules required for the tutorial&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;ROOT&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TMVA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TFile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TTree&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TCut&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;subprocess&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;call&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;os.path&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;isfile&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Welcome to JupyROOT 6.23/01
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Setup-TMVA&quot;&gt;Setup TMVA&lt;a class=&quot;anchor-link&quot; href=&quot;#Setup-TMVA&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;TMVA requires initialization the PyMVA to utilize PyTorch. PyMVA is the interface for third-party MVA tools based on Python. It is created to make powerful external libraries easily accessible with a direct integration into the TMVA workflow. All PyMVA methods provide the same plug-and-play mechanisms as the TMVA methods. Because the base method of PyMVA is inherited from the TMVA base method, all options of internal TMVA methods apply for PyMVA methods as well.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TMVA&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Tools&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;TMVA&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;PyMethodBase&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;PyInitialize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TFile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;TMVA.root&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;RECREATE&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;factory&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TMVA&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Factory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;TMVAClassification&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                       &lt;span class=&quot;s1&quot;&gt;&amp;#39;!V:!Silent:Color:DrawProgressBar:&amp;#39;&lt;/span&gt;
                       &lt;span class=&quot;s1&quot;&gt;&amp;#39;Transformations=D,G:AnalysisType=Classification&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;DataLoader&quot;&gt;DataLoader&lt;a class=&quot;anchor-link&quot; href=&quot;#DataLoader&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Below we start by downloading the dataset example dataset. The signal and background are loaded and read from the dataset. Finally we define our dataloader with options to help us control the split.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;isfile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;tmva_class_example.root&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;curl&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;-O&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;http://root.cern.ch/files/tmva_class_example.root&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TFile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;tmva_class_example.root&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;signal&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;TreeS&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;background&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;TreeB&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;dataloader&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TMVA&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataLoader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;dataset&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;branch&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;signal&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GetListOfBranches&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;dataloader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AddVariable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;branch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GetName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;dataloader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AddSignalTree&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;signal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dataloader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AddBackgroundTree&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;background&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dataloader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;PrepareTrainingAndTestTree&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TCut&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
                                      &lt;span class=&quot;s1&quot;&gt;&amp;#39;nTrain_Signal=4000:&amp;#39;&lt;/span&gt;
                                      &lt;span class=&quot;s1&quot;&gt;&amp;#39;nTrain_Background=4000:&amp;#39;&lt;/span&gt;
                                      &lt;span class=&quot;s1&quot;&gt;&amp;#39;SplitMode=Random:&amp;#39;&lt;/span&gt;
                                      &lt;span class=&quot;s1&quot;&gt;&amp;#39;NormMode=NumEvents:!V&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;DataSetInfo              : [dataset] : Added class &amp;#34;Signal&amp;#34;
                         : Add Tree TreeS of type Signal with 6000 events
DataSetInfo              : [dataset] : Added class &amp;#34;Background&amp;#34;
                         : Add Tree TreeB of type Background with 6000 events
                         : Dataset[dataset] : Class index : 0  name : Signal
                         : Dataset[dataset] : Class index : 1  name : Background
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Generate-model&quot;&gt;Generate model&lt;a class=&quot;anchor-link&quot; href=&quot;#Generate-model&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Model Definition.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Sequential&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;linear_1&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Linear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;in_features&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;out_features&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ReLU&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;linear_2&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Linear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;in_features&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;out_features&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;softmax&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Softmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Define loss function and the Optimizer.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MSELoss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SGD&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Define the train and predict function. Note that the arguments to train and predict function need to be fixed since we call the same method internally in the TMVA interface backend. A user may control the training process and the loop inside.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;div class=&quot;flash flash-success&quot;&gt;
    &lt;svg class=&quot;octicon octicon-checklist octicon octicon-checklist&quot; viewBox=&quot;0 0 16 16&quot; version=&quot;1.1&quot; width=&quot;16&quot; height=&quot;16&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M16 8.5l-6 6-3-3L8.5 10l1.5 1.5L14.5 7 16 8.5zM5.7 12.2l.8.8H2c-.55 0-1-.45-1-1V3c0-.55.45-1 1-1h7c.55 0 1 .45 1 1v6.5l-.8-.8c-.39-.39-1.03-.39-1.42 0L5.7 10.8a.996.996 0 000 1.41v-.01zM4 4h5V3H4v1zm0 2h5V5H4v1zm0 2h3V7H4v1zM3 9H2v1h1V9zm0-2H2v1h1V7zm0-2H2v1h1V5zm0-2H2v1h1V3z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;
    &lt;strong&gt;Tip: &lt;/strong&gt;You may implement the training loop using &lt;code&gt;tqdm&lt;/code&gt; for a nice progress bar! üòÅ
&lt;/div&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_loader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val_loader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;criterion&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;save_best&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scheduler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;trainer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;schedule&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;schedulerSteps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scheduler&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;best_val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Training Loop&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Set to train mode&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;running_train_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;running_val_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_loader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;trainer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zero_grad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;train_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;criterion&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;train_loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;backward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;trainer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

            &lt;span class=&quot;c1&quot;&gt;# print train statistics&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;running_train_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;63&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;# print every 64 mini-batches&lt;/span&gt;
                &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;[Epoch &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;] train loss:&amp;quot;&lt;/span&gt;
                      &lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;running_train_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt; &lt;span class=&quot;si&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.3f&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;running_train_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;schedule&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;schedule&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;schedulerSteps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# Validation Loop&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Set to eval mode&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;no_grad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val_loader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;val_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;criterion&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;running_val_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val_loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

            &lt;span class=&quot;n&quot;&gt;curr_val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;running_val_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val_loader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;save_best&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
               &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;best_val&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                   &lt;span class=&quot;n&quot;&gt;best_val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;curr_val&lt;/span&gt;
               &lt;span class=&quot;n&quot;&gt;best_val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;save_best&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;curr_val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;best_val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

            &lt;span class=&quot;c1&quot;&gt;# print val statistics per epoch&lt;/span&gt;
            &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;[Epoch &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;] val loss: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;curr_val&lt;/span&gt; &lt;span class=&quot;si&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.3f&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;running_val_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;

    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Finished Training on &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; Epochs!&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Define predict function.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;div class=&quot;flash flash-warn&quot;&gt;
    &lt;svg class=&quot;octicon octicon-zap octicon octicon-zap&quot; viewBox=&quot;0 0 10 16&quot; version=&quot;1.1&quot; width=&quot;10&quot; height=&quot;16&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M10 7H6l3-7-9 9h4l-3 7 9-9z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;
    &lt;strong&gt;Important: &lt;/strong&gt;TMVA&amp;#8217;s interface deals with the dataset by converting them to numpy arrays internally and later serving torch dataloaders which we indeed pass into our training function. But, note that at test/inference time, we are presented with numpy array inputs and we need to convert those to PyTorch tensors within the &lt;code&gt;predict&lt;/code&gt; method. Similarly, we need to return the predicted numpy array back to TMVA.
&lt;/div&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test_X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Set to eval mode&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
   
    &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;no_grad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;predictions&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;predictions&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;numpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Now that we have defined the necessary components required for downloading, preprocessing, dataloaders,
building our model, training loop, and a prediction method for evaluation. We need to share some of these components with the TMVA Interface backend.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;p&gt;This can be simply done by defining dictionary: &lt;code&gt;load_model_custom_objects&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Keys:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&quot;optimizer&quot;&lt;/li&gt;
&lt;li&gt;&quot;criterion&quot;&lt;/li&gt;
&lt;li&gt;&quot;train_func&quot;&lt;/li&gt;
&lt;li&gt;&quot;predict_func&quot;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;
&lt;div class=&quot;flash&quot;&gt;
    &lt;svg class=&quot;octicon octicon-info octicon octicon-info octicon octicon-info&quot; viewBox=&quot;0 0 14 16&quot; version=&quot;1.1&quot; width=&quot;14&quot; height=&quot;16&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M6.3 5.69a.942.942 0 01-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 01-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;
    &lt;strong&gt;Note: &lt;/strong&gt;The keys and the name of the dictionary need to be as specified!
&lt;/div&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Pass optimizer, loss, train, predict function objects,&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# defined earlier, as values to the dictionary&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;load_model_custom_objects&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;optimizer&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;criterion&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                             &lt;span class=&quot;s2&quot;&gt;&amp;quot;train_func&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;predict_func&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Save-&amp;amp;-Store-model&quot;&gt;Save &amp;amp; Store model&lt;a class=&quot;anchor-link&quot; href=&quot;#Save-&amp;amp;-Store-model&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Since the TMVA interface requires us to load the model from the stored file without re-definition of model class, we need to convert the model to torchscript before saving for achieving this functionality.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;script&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;model.pt&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Sequential(
  (linear_1): Linear(in_features=4, out_features=64, bias=True)
  (relu): ReLU()
  (linear_2): Linear(in_features=64, out_features=2, bias=True)
  (softmax): Softmax(dim=1)
)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Book-TMVA-methods&quot;&gt;Book TMVA methods&lt;a class=&quot;anchor-link&quot; href=&quot;#Book-TMVA-methods&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Now we will proceed by booking the MVA methods which we require. We book Fisher and PyTorch methods.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;factory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BookMethod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dataloader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TMVA&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Types&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kFisher&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Fisher&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                   &lt;span class=&quot;s1&quot;&gt;&amp;#39;!H:!V:Fisher:VarTransform=D,G&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;factory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BookMethod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dataloader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TMVA&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Types&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kPyTorch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;PyTorch&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                   &lt;span class=&quot;s1&quot;&gt;&amp;#39;H:!V:VarTransform=D,G:FilenameModel=model.pt:&amp;#39;&lt;/span&gt;
                   &lt;span class=&quot;s1&quot;&gt;&amp;#39;NumEpochs=20:BatchSize=32&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;custom objects for loading model :  {&amp;#39;optimizer&amp;#39;: &amp;lt;class &amp;#39;torch.optim.sgd.SGD&amp;#39;&amp;gt;, &amp;#39;criterion&amp;#39;: MSELoss(), &amp;#39;train_func&amp;#39;: &amp;lt;function train at 0x1307b99e0&amp;gt;, &amp;#39;predict_func&amp;#39;: &amp;lt;function predict at 0x1307b9f80&amp;gt;}
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;&amp;lt;cppyy.gbl.TMVA.MethodPyTorch object at 0x7f908f837600&amp;gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Factory                  : Booking method: &lt;span class=&quot;ansi-bold&quot;&gt;Fisher&lt;/span&gt;
                         : 
Fisher                   : [dataset] : Create Transformation &amp;#34;D&amp;#34; with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable &amp;#39;var1&amp;#39; &amp;lt;---&amp;gt; Output : variable &amp;#39;var1&amp;#39;
                         : Input : variable &amp;#39;var2&amp;#39; &amp;lt;---&amp;gt; Output : variable &amp;#39;var2&amp;#39;
                         : Input : variable &amp;#39;var3&amp;#39; &amp;lt;---&amp;gt; Output : variable &amp;#39;var3&amp;#39;
                         : Input : variable &amp;#39;var4&amp;#39; &amp;lt;---&amp;gt; Output : variable &amp;#39;var4&amp;#39;
Fisher                   : [dataset] : Create Transformation &amp;#34;G&amp;#34; with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable &amp;#39;var1&amp;#39; &amp;lt;---&amp;gt; Output : variable &amp;#39;var1&amp;#39;
                         : Input : variable &amp;#39;var2&amp;#39; &amp;lt;---&amp;gt; Output : variable &amp;#39;var2&amp;#39;
                         : Input : variable &amp;#39;var3&amp;#39; &amp;lt;---&amp;gt; Output : variable &amp;#39;var3&amp;#39;
                         : Input : variable &amp;#39;var4&amp;#39; &amp;lt;---&amp;gt; Output : variable &amp;#39;var4&amp;#39;
Factory                  : Booking method: &lt;span class=&quot;ansi-bold&quot;&gt;PyTorch&lt;/span&gt;
                         : 
PyTorch                  : [dataset] : Create Transformation &amp;#34;D&amp;#34; with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable &amp;#39;var1&amp;#39; &amp;lt;---&amp;gt; Output : variable &amp;#39;var1&amp;#39;
                         : Input : variable &amp;#39;var2&amp;#39; &amp;lt;---&amp;gt; Output : variable &amp;#39;var2&amp;#39;
                         : Input : variable &amp;#39;var3&amp;#39; &amp;lt;---&amp;gt; Output : variable &amp;#39;var3&amp;#39;
                         : Input : variable &amp;#39;var4&amp;#39; &amp;lt;---&amp;gt; Output : variable &amp;#39;var4&amp;#39;
PyTorch                  : [dataset] : Create Transformation &amp;#34;G&amp;#34; with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable &amp;#39;var1&amp;#39; &amp;lt;---&amp;gt; Output : variable &amp;#39;var1&amp;#39;
                         : Input : variable &amp;#39;var2&amp;#39; &amp;lt;---&amp;gt; Output : variable &amp;#39;var2&amp;#39;
                         : Input : variable &amp;#39;var3&amp;#39; &amp;lt;---&amp;gt; Output : variable &amp;#39;var3&amp;#39;
                         : Input : variable &amp;#39;var4&amp;#39; &amp;lt;---&amp;gt; Output : variable &amp;#39;var4&amp;#39;
                         : Using PyTorch - setting special configuration options 
                         : Using PyTorch version 1
                         :  Setup PyTorch Model 
                         : Loaded pytorch train function: 
                         : Loaded pytorch optimizer: 
                         : Loaded pytorch loss function: 
                         : Loaded pytorch predict function: 
                         : Load model from file: model.pt
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Training&quot;&gt;Training&lt;a class=&quot;anchor-link&quot; href=&quot;#Training&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Call the &lt;code&gt;TrainAllMethods&lt;/code&gt; from the factory object to initiate training.
Note: The output of this cell has been hidden for better readability and to avoid the verbosity.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;factory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TrainAllMethods&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;RecursiveScriptModule(
  original_name=Sequential
  (linear_1): RecursiveScriptModule(original_name=Linear)
  (relu): RecursiveScriptModule(original_name=ReLU)
  (linear_2): RecursiveScriptModule(original_name=Linear)
  (softmax): RecursiveScriptModule(original_name=Softmax)
)
[Epoch 1, 64] train loss:0.224
[Epoch 1, 128] train loss:0.197
[Epoch 1, 192] train loss:0.179
[Epoch 1] val loss: 0.172
[Epoch 2, 64] train loss:0.168
[Epoch 2, 128] train loss:0.164
[Epoch 2, 192] train loss:0.155
[Epoch 2] val loss: 0.154
[Epoch 3, 64] train loss:0.151
[Epoch 3, 128] train loss:0.152
[Epoch 3, 192] train loss:0.144
[Epoch 3] val loss: 0.145
[Epoch 4, 64] train loss:0.142
[Epoch 4, 128] train loss:0.146
[Epoch 4, 192] train loss:0.137
[Epoch 4] val loss: 0.140
[Epoch 5, 64] train loss:0.136
[Epoch 5, 128] train loss:0.142
[Epoch 5, 192] train loss:0.132
[Epoch 5] val loss: 0.136
[Epoch 6, 64] train loss:0.132
[Epoch 6, 128] train loss:0.138
[Epoch 6, 192] train loss:0.129
[Epoch 6] val loss: 0.133
[Epoch 7, 64] train loss:0.129
[Epoch 7, 128] train loss:0.136
[Epoch 7, 192] train loss:0.126
[Epoch 7] val loss: 0.131
[Epoch 8, 64] train loss:0.127
[Epoch 8, 128] train loss:0.134
[Epoch 8, 192] train loss:0.123
[Epoch 8] val loss: 0.129
[Epoch 9, 64] train loss:0.124
[Epoch 9, 128] train loss:0.132
[Epoch 9, 192] train loss:0.121
[Epoch 9] val loss: 0.127
[Epoch 10, 64] train loss:0.122
[Epoch 10, 128] train loss:0.130
[Epoch 10, 192] train loss:0.119
[Epoch 10] val loss: 0.125
[Epoch 11, 64] train loss:0.121
[Epoch 11, 128] train loss:0.128
[Epoch 11, 192] train loss:0.117
[Epoch 11] val loss: 0.124
[Epoch 12, 64] train loss:0.119
[Epoch 12, 128] train loss:0.127
[Epoch 12, 192] train loss:0.116
[Epoch 12] val loss: 0.122
[Epoch 13, 64] train loss:0.117
[Epoch 13, 128] train loss:0.125
[Epoch 13, 192] train loss:0.114
[Epoch 13] val loss: 0.121
[Epoch 14, 64] train loss:0.116
[Epoch 14, 128] train loss:0.124
[Epoch 14, 192] train loss:0.113
[Epoch 14] val loss: 0.120
[Epoch 15, 64] train loss:0.114
[Epoch 15, 128] train loss:0.123
[Epoch 15, 192] train loss:0.112
[Epoch 15] val loss: 0.119
[Epoch 16, 64] train loss:0.113
[Epoch 16, 128] train loss:0.122
[Epoch 16, 192] train loss:0.111
[Epoch 16] val loss: 0.118
[Epoch 17, 64] train loss:0.112
[Epoch 17, 128] train loss:0.121
[Epoch 17, 192] train loss:0.109
[Epoch 17] val loss: 0.117
[Epoch 18, 64] train loss:0.111
[Epoch 18, 128] train loss:0.120
[Epoch 18, 192] train loss:0.108
[Epoch 18] val loss: 0.116
[Epoch 19, 64] train loss:0.110
[Epoch 19, 128] train loss:0.119
[Epoch 19, 192] train loss:0.108
[Epoch 19] val loss: 0.115
[Epoch 20, 64] train loss:0.109
[Epoch 20, 128] train loss:0.118
[Epoch 20, 192] train loss:0.107
[Epoch 20] val loss: 0.114
Finished Training on 20 Epochs!
Factory                  : &lt;span class=&quot;ansi-bold&quot;&gt;Train all methods&lt;/span&gt;
                         : Building event vectors for type 2 Signal
                         : Dataset[dataset] :  create input formulas for tree TreeS
                         : Building event vectors for type 2 Background
                         : Dataset[dataset] :  create input formulas for tree TreeB
DataSetFactory           : [dataset] : Number of events in input trees
                         : 
                         : 
                         : Number of training and testing events
                         : ---------------------------------------------------------------------------
                         : Signal     -- training events            : 4000
                         : Signal     -- testing events             : 2000
                         : Signal     -- training and testing events: 6000
                         : Background -- training events            : 4000
                         : Background -- testing events             : 2000
                         : Background -- training and testing events: 6000
                         : 
DataSetInfo              : Correlation matrix (Signal):
                         : ----------------------------------------
                         :             var1    var2    var3    var4
                         :    var1:  +1.000  +0.391  +0.590  +0.813
                         :    var2:  +0.391  +1.000  +0.692  +0.734
                         :    var3:  +0.590  +0.692  +1.000  +0.851
                         :    var4:  +0.813  +0.734  +0.851  +1.000
                         : ----------------------------------------
DataSetInfo              : Correlation matrix (Background):
                         : ----------------------------------------
                         :             var1    var2    var3    var4
                         :    var1:  +1.000  +0.855  +0.914  +0.965
                         :    var2:  +0.855  +1.000  +0.927  +0.936
                         :    var3:  +0.914  +0.927  +1.000  +0.970
                         :    var4:  +0.965  +0.936  +0.970  +1.000
                         : ----------------------------------------
DataSetFactory           : [dataset] :  
                         : 
Factory                  : [dataset] : Create Transformation &amp;#34;D&amp;#34; with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable &amp;#39;var1&amp;#39; &amp;lt;---&amp;gt; Output : variable &amp;#39;var1&amp;#39;
                         : Input : variable &amp;#39;var2&amp;#39; &amp;lt;---&amp;gt; Output : variable &amp;#39;var2&amp;#39;
                         : Input : variable &amp;#39;var3&amp;#39; &amp;lt;---&amp;gt; Output : variable &amp;#39;var3&amp;#39;
                         : Input : variable &amp;#39;var4&amp;#39; &amp;lt;---&amp;gt; Output : variable &amp;#39;var4&amp;#39;
Factory                  : [dataset] : Create Transformation &amp;#34;G&amp;#34; with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable &amp;#39;var1&amp;#39; &amp;lt;---&amp;gt; Output : variable &amp;#39;var1&amp;#39;
                         : Input : variable &amp;#39;var2&amp;#39; &amp;lt;---&amp;gt; Output : variable &amp;#39;var2&amp;#39;
                         : Input : variable &amp;#39;var3&amp;#39; &amp;lt;---&amp;gt; Output : variable &amp;#39;var3&amp;#39;
                         : Input : variable &amp;#39;var4&amp;#39; &amp;lt;---&amp;gt; Output : variable &amp;#39;var4&amp;#39;
                         : Preparing the Decorrelation transformation...
                         : Preparing the Gaussian transformation...
TFHandler_Factory        : Variable        Mean        RMS   [        Min        Max ]
                         : -----------------------------------------------------------
                         :     var1:  0.0084120     1.0019   [    -3.1195     5.7307 ]
                         :     var2:  0.0078511    0.99981   [    -3.1195     5.7307 ]
                         :     var3:  0.0083128     1.0011   [    -3.1195     5.7307 ]
                         :     var4:  0.0076997    0.99886   [    -3.1195     5.7307 ]
                         : -----------------------------------------------------------
Factory                  : Train method: Fisher for Classification
                         : 
                         : Preparing the Decorrelation transformation...
                         : Preparing the Gaussian transformation...
TFHandler_Fisher         : Variable        Mean        RMS   [        Min        Max ]
                         : -----------------------------------------------------------
                         :     var1:  0.0084120     1.0019   [    -3.1195     5.7307 ]
                         :     var2:  0.0078511    0.99981   [    -3.1195     5.7307 ]
                         :     var3:  0.0083128     1.0011   [    -3.1195     5.7307 ]
                         :     var4:  0.0076997    0.99886   [    -3.1195     5.7307 ]
                         : -----------------------------------------------------------
Fisher                   : Results for Fisher coefficients:
                         : NOTE: The coefficients must be applied to TRANFORMED variables
                         :   List of the transformation: 
                         :   -- Deco
                         :   -- Gauss
                         : -----------------------
                         : Variable:  Coefficient:
                         : -----------------------
                         :     var1:       -0.221
                         :     var2:       -0.055
                         :     var3:       +0.032
                         :     var4:       +0.474
                         : (offset):       -0.002
                         : -----------------------
                         : Elapsed time for training with 8000 events: 0.0486 sec         
Fisher                   : [dataset] : Evaluation of Fisher on training sample (8000 events)
                         : Elapsed time for evaluation of 8000 events: 0.0246 sec       
                         : Creating xml weight file: &lt;span class=&quot;ansi-cyan-fg&quot;&gt;dataset/weights/TMVAClassification_Fisher.weights.xml&lt;/span&gt;
                         : Creating standalone class: &lt;span class=&quot;ansi-cyan-fg&quot;&gt;dataset/weights/TMVAClassification_Fisher.class.C&lt;/span&gt;
Factory                  : Training finished
                         : 
Factory                  : Train method: PyTorch for Classification
                         : 
                         : 
                         : &lt;span class=&quot;ansi-bold&quot;&gt;================================================================&lt;/span&gt;
                         : &lt;span class=&quot;ansi-bold&quot;&gt;H e l p   f o r   M V A   m e t h o d   [ PyTorch ] :&lt;/span&gt;
                         : 
                         : PyTorch is a scientific computing package supporting
                         : automatic differentiation. This method wraps the training
                         : and predictions steps of the PyTorch Python package for
                         : TMVA, so that dataloading, preprocessing and evaluation
                         : can be done within the TMVA system. To use this PyTorch
                         : interface, you need to generatea model with PyTorch first.
                         : Then, this model can be loaded and trained in TMVA.
                         : 
                         : 
                         : &amp;lt;Suppress this message by specifying &amp;#34;!H&amp;#34; in the booking option&amp;gt;
                         : &lt;span class=&quot;ansi-bold&quot;&gt;================================================================&lt;/span&gt;
                         : 
                         : Preparing the Decorrelation transformation...
                         : Preparing the Gaussian transformation...
TFHandler_PyTorch        : Variable        Mean        RMS   [        Min        Max ]
                         : -----------------------------------------------------------
                         :     var1:  0.0084120     1.0019   [    -3.1195     5.7307 ]
                         :     var2:  0.0078511    0.99981   [    -3.1195     5.7307 ]
                         :     var3:  0.0083128     1.0011   [    -3.1195     5.7307 ]
                         :     var4:  0.0076997    0.99886   [    -3.1195     5.7307 ]
                         : -----------------------------------------------------------
TFHandler_PyTorch        : Variable        Mean        RMS   [        Min        Max ]
                         : -----------------------------------------------------------
                         :     var1:  0.0084120     1.0019   [    -3.1195     5.7307 ]
                         :     var2:  0.0078511    0.99981   [    -3.1195     5.7307 ]
                         :     var3:  0.0083128     1.0011   [    -3.1195     5.7307 ]
                         :     var4:  0.0076997    0.99886   [    -3.1195     5.7307 ]
                         : -----------------------------------------------------------
                         : Split TMVA training data in 6400 training events and 1600 validation events
                         : Print Training Model Architecture
                         : Option SaveBestOnly: Only model weights with smallest validation loss will be stored
                         : Elapsed time for training with 8000 events: 4.91 sec         
PyTorch                  : [dataset] : Evaluation of PyTorch on training sample (8000 events)
                         : Elapsed time for evaluation of 8000 events: 0.0518 sec       
                         : Creating xml weight file: &lt;span class=&quot;ansi-cyan-fg&quot;&gt;dataset/weights/TMVAClassification_PyTorch.weights.xml&lt;/span&gt;
                         : Creating standalone class: &lt;span class=&quot;ansi-cyan-fg&quot;&gt;dataset/weights/TMVAClassification_PyTorch.class.C&lt;/span&gt;
Factory                  : Training finished
                         : 
                         : Ranking input variables (method specific)...
Fisher                   : Ranking result (top variable is best ranked)
                         : -------------------------------
                         : Rank : Variable  : Discr. power
                         : -------------------------------
                         :    1 : var4      : 1.956e-01
                         :    2 : var1      : 4.019e-02
                         :    3 : var2      : 3.086e-03
                         :    4 : var3      : 2.351e-04
                         : -------------------------------
                         : No variable ranking supplied by classifier: PyTorch
Factory                  : === Destroy and recreate all methods via weight files for testing ===
                         : 
                         : Reading weight file: &lt;span class=&quot;ansi-cyan-fg&quot;&gt;dataset/weights/TMVAClassification_Fisher.weights.xml&lt;/span&gt;
                         : Reading weight file: &lt;span class=&quot;ansi-cyan-fg&quot;&gt;dataset/weights/TMVAClassification_PyTorch.weights.xml&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;0%, time left: unknown
7%, time left: 0 sec
13%, time left: 0 sec
19%, time left: 0 sec
25%, time left: 0 sec
32%, time left: 0 sec
38%, time left: 0 sec
44%, time left: 0 sec
50%, time left: 0 sec
57%, time left: 0 sec
63%, time left: 0 sec
69%, time left: 0 sec
75%, time left: 0 sec
82%, time left: 0 sec
88%, time left: 0 sec
94%, time left: 0 sec
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Testing&quot;&gt;Testing&lt;a class=&quot;anchor-link&quot; href=&quot;#Testing&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Call the &lt;code&gt;TestAllMethods&lt;/code&gt; from the factory object to initiate testing.
Note: The output of this cell has been hidden for better readability and to avoid the verbosity.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;factory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TestAllMethods&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;custom objects for loading model :  {&amp;#39;optimizer&amp;#39;: &amp;lt;class &amp;#39;torch.optim.sgd.SGD&amp;#39;&amp;gt;, &amp;#39;criterion&amp;#39;: MSELoss(), &amp;#39;train_func&amp;#39;: &amp;lt;function train at 0x1307b99e0&amp;gt;, &amp;#39;predict_func&amp;#39;: &amp;lt;function predict at 0x1307b9f80&amp;gt;}
Factory                  : &lt;span class=&quot;ansi-bold&quot;&gt;Test all methods&lt;/span&gt;
Factory                  : Test method: Fisher for Classification performance
                         : 
Fisher                   : [dataset] : Evaluation of Fisher on testing sample (4000 events)
                         : Elapsed time for evaluation of 4000 events: 0.016 sec       
Factory                  : Test method: PyTorch for Classification performance
                         : 
                         :  Setup PyTorch Model 
                         : Loaded pytorch train function: 
                         : Loaded pytorch optimizer: 
                         : Loaded pytorch loss function: 
                         : Loaded pytorch predict function: 
                         : Load model from file: dataset/weights/TrainedModel_PyTorch.pt
PyTorch                  : [dataset] : Evaluation of PyTorch on testing sample (4000 events)
                         : Elapsed time for evaluation of 4000 events: 0.0258 sec       
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;0%, time left: unknown
7%, time left: 0 sec
13%, time left: 0 sec
19%, time left: 0 sec
25%, time left: 0 sec
32%, time left: 0 sec
38%, time left: 0 sec
44%, time left: 0 sec
50%, time left: 0 sec
57%, time left: 0 sec
63%, time left: 0 sec
69%, time left: 0 sec
75%, time left: 0 sec
82%, time left: 0 sec
88%, time left: 0 sec
94%, time left: 0 sec
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Evaluation&quot;&gt;Evaluation&lt;a class=&quot;anchor-link&quot; href=&quot;#Evaluation&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Call the &lt;code&gt;EvaluateAllMethods&lt;/code&gt; from the factory object to initiate evaluation. Here we evaluate all methods and compare their performances, computing efficiencies, ROC curves, etc. using both training and tetsing data sets.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;factory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;EvaluateAllMethods&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Factory                  : &lt;span class=&quot;ansi-bold&quot;&gt;Evaluate all methods&lt;/span&gt;
Factory                  : Evaluate classifier: Fisher
                         : 
TFHandler_Fisher         : Variable        Mean        RMS   [        Min        Max ]
                         : -----------------------------------------------------------
                         :     var1:   0.015907    0.98605   [    -2.8645     3.5534 ]
                         :     var2:  0.0046941     1.0002   [    -3.2858     3.3764 ]
                         :     var3:   0.017030    0.99729   [    -2.9032     5.7307 ]
                         :     var4: -0.0011286    0.98455   [    -2.8276     3.2696 ]
                         : -----------------------------------------------------------
Fisher                   : [dataset] : Loop over test events and fill histograms with classifier response...
                         : 
TFHandler_Fisher         : Variable        Mean        RMS   [        Min        Max ]
                         : -----------------------------------------------------------
                         :     var1:   0.015907    0.98605   [    -2.8645     3.5534 ]
                         :     var2:  0.0046941     1.0002   [    -3.2858     3.3764 ]
                         :     var3:   0.017030    0.99729   [    -2.9032     5.7307 ]
                         :     var4: -0.0011286    0.98455   [    -2.8276     3.2696 ]
                         : -----------------------------------------------------------
Factory                  : Evaluate classifier: PyTorch
                         : 
TFHandler_PyTorch        : Variable        Mean        RMS   [        Min        Max ]
                         : -----------------------------------------------------------
                         :     var1:   0.015907    0.98605   [    -2.8645     3.5534 ]
                         :     var2:  0.0046941     1.0002   [    -3.2858     3.3764 ]
                         :     var3:   0.017030    0.99729   [    -2.9032     5.7307 ]
                         :     var4: -0.0011286    0.98455   [    -2.8276     3.2696 ]
                         : -----------------------------------------------------------
PyTorch                  : [dataset] : Loop over test events and fill histograms with classifier response...
                         : 
TFHandler_PyTorch        : Variable        Mean        RMS   [        Min        Max ]
                         : -----------------------------------------------------------
                         :     var1:   0.015907    0.98605   [    -2.8645     3.5534 ]
                         :     var2:  0.0046941     1.0002   [    -3.2858     3.3764 ]
                         :     var3:   0.017030    0.99729   [    -2.9032     5.7307 ]
                         :     var4: -0.0011286    0.98455   [    -2.8276     3.2696 ]
                         : -----------------------------------------------------------
                         : 
                         : Evaluation results ranked by best signal efficiency and purity (area)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet       MVA                       
                         : Name:         Method:          ROC-integ
                         : dataset       PyTorch        : 0.924
                         : dataset       Fisher         : 0.880
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
                         : Testing efficiency compared to training efficiency (overtraining check)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet              MVA              Signal efficiency: from test sample (from training sample) 
                         : Name:                Method:          @B=0.01             @B=0.10            @B=0.30   
                         : -------------------------------------------------------------------------------------------------------------------
                         : dataset              PyTorch        : 0.317 (0.332)       0.757 (0.761)      0.946 (0.944)
                         : dataset              Fisher         : 0.192 (0.190)       0.645 (0.646)      0.884 (0.876)
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
Dataset:dataset          : Created tree &amp;#39;TestTree&amp;#39; with 4000 events
                         : 
Dataset:dataset          : Created tree &amp;#39;TrainTree&amp;#39; with 8000 events
                         : 
Factory                  : &lt;span class=&quot;ansi-bold&quot;&gt;Thank you for using TMVA!&lt;/span&gt;
                         : &lt;span class=&quot;ansi-bold&quot;&gt;For citation information, please visit: http://tmva.sf.net/citeTMVA.html&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Plots&quot;&gt;Plots&lt;a class=&quot;anchor-link&quot; href=&quot;#Plots&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;We can now analyze the results using histogram plots and ROC curves. Several histograms are produced after calling evaluation, which can be examined with the TMVA GUI or directly using the output file.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;roc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;factory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GetROCCurve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dataloader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;roc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Draw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;hr /&gt;

&lt;p&gt;With this I've wrapped up my project. Stay tuned for my final post about my GSoC journey at CERN.&lt;/p&gt;
&lt;p&gt;Feel free to ask questions below in the comments or on the &lt;a href=&quot;https://root-forum.cern.ch/&quot;&gt;root forum&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;p&gt;Until next time,&lt;/p&gt;
&lt;p&gt;Anirudh Dagar&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name>Anirudh Dagar</name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://anirudhdagar.github.io/gsoc/images/tmva.jpg" /><media:content medium="image" url="https://anirudhdagar.github.io/gsoc/images/tmva.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Phase 2 Evaluation</title><link href="https://anirudhdagar.github.io/gsoc/coding/evaluation/gsoc/2020/08/02/Phase-2-Ends.html" rel="alternate" type="text/html" title="Phase 2 Evaluation" /><published>2020-08-02T00:00:00-05:00</published><updated>2020-08-02T00:00:00-05:00</updated><id>https://anirudhdagar.github.io/gsoc/coding/evaluation/gsoc/2020/08/02/Phase-2-Ends</id><content type="html" xml:base="https://anirudhdagar.github.io/gsoc/coding/evaluation/gsoc/2020/08/02/Phase-2-Ends.html">&lt;p&gt;&lt;img alt=&quot;Can't See? Something went wrong!&quot; src=&quot;/gsoc/images/progress.gif&quot; width=&quot;100%&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;progress&quot;&gt;Progress&lt;/h1&gt;

&lt;p&gt;In continuation to the Phase 1 updates, this is a short update on my progress till the Phase 2 Evaluation in GSoC 2020. A major concern regarding the TMVA PyTorch Interface in the last 2 months has been the &lt;code class=&quot;highlighter-rouge&quot;&gt;train&lt;/code&gt; method. I‚Äôve finally been able to solve the issues and bugs and have incorporated a simplified version of &lt;code class=&quot;highlighter-rouge&quot;&gt;train&lt;/code&gt; method successfully. Below are the goals set before the 2nd evaluation according to my proposal, of which I was able to complete the following:&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Header MethodPyTorch&lt;/strong&gt;&lt;/p&gt;
&lt;ul class=&quot;task-list&quot;&gt;
  &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Add Initial Structure for &lt;code class=&quot;highlighter-rouge&quot;&gt;MethodPyTorch.h&lt;/code&gt; header file.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;Class MethodPyTorch&lt;/strong&gt;
Implement the basic outline of &lt;code class=&quot;highlighter-rouge&quot;&gt;MethodPyTorch.cxx&lt;/code&gt; Class.&lt;/p&gt;

&lt;ul class=&quot;task-list&quot;&gt;
  &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Implement the &lt;code class=&quot;highlighter-rouge&quot;&gt;DeclareOptions&lt;/code&gt; method&lt;/li&gt;
  &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Implement &lt;code class=&quot;highlighter-rouge&quot;&gt;ProcessOptions&lt;/code&gt; methods&lt;/li&gt;
  &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Implement &lt;code class=&quot;highlighter-rouge&quot;&gt;SetupTorchModel&lt;/code&gt; method&lt;/li&gt;
  &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; /&gt;Implement train methods. (Partially Completed)
    &lt;ul class=&quot;task-list&quot;&gt;
      &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Implement simple basic structure for training&lt;/li&gt;
      &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Add ability to load code from users&lt;/li&gt;
      &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Convert numpy based dataloaders in TMVA to PyTorch dataloaders&lt;/li&gt;
      &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Use default optimizer (optional optimizer SGD)&lt;/li&gt;
      &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; /&gt;Add savebest model&lt;/li&gt;
      &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; /&gt;Add scheduler&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Implement &lt;code class=&quot;highlighter-rouge&quot;&gt;GetNumValidationSamples&lt;/code&gt;&lt;/li&gt;
  &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Implement Validation in &lt;code class=&quot;highlighter-rouge&quot;&gt;train_func&lt;/code&gt;&lt;/li&gt;
  &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Implement &lt;code class=&quot;highlighter-rouge&quot;&gt;helper&lt;/code&gt; method&lt;/li&gt;
  &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Implement the Tests
    &lt;ul class=&quot;task-list&quot;&gt;
      &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Implement &lt;code class=&quot;highlighter-rouge&quot;&gt;testPyTorchClassification.C&lt;/code&gt; (WIP (Training works))&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The &lt;code class=&quot;highlighter-rouge&quot;&gt;train&lt;/code&gt; method in the &lt;code class=&quot;highlighter-rouge&quot;&gt;MethodPyTorch&lt;/code&gt; is almost complete. I need to add features for Keras like callbacks, which after discussing with my mentors, we‚Äôve decided to implement in the next month. I‚Äôd like to thank Lorenzo for helping me out when I was stuck with issues related to &lt;code class=&quot;highlighter-rouge&quot;&gt;user code loading&lt;/code&gt; in the TMVA Interface.&lt;/p&gt;

&lt;p&gt;In the final month, I‚Äôll be working on the prediction side of the interface, involving implementation of the &lt;code class=&quot;highlighter-rouge&quot;&gt;GetMvaValues&lt;/code&gt; method for Classification, &lt;code class=&quot;highlighter-rouge&quot;&gt;GetRegressionValues&lt;/code&gt; method for Regression and &lt;code class=&quot;highlighter-rouge&quot;&gt;GetMulticlassValues&lt;/code&gt; method for MultiClass multi-variate analysis.&lt;/p&gt;

&lt;p&gt;This will also involve the utilization of user-defined &lt;code class=&quot;highlighter-rouge&quot;&gt;predict&lt;/code&gt; function in PyTorch.&lt;/p&gt;

&lt;p&gt;Later, I‚Äôll be implementing all the remaining tests and tutorials.&lt;/p&gt;

&lt;p&gt;I‚Äôm feeling confident about my progress and I shall be able to wrap up the complete interface in the next couple of weeks!üí™&lt;/p&gt;</content><author><name></name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://anirudhdagar.github.io/gsoc/images/progress.gif" /><media:content medium="image" url="https://anirudhdagar.github.io/gsoc/images/progress.gif" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Internals: TMVA PyTorch Interface</title><link href="https://anirudhdagar.github.io/gsoc/tmva/pytorch/torchscript/2020/07/22/Internals-TMVA-PyTorch-Interface.html" rel="alternate" type="text/html" title="Internals: TMVA PyTorch Interface" /><published>2020-07-22T00:00:00-05:00</published><updated>2020-07-22T00:00:00-05:00</updated><id>https://anirudhdagar.github.io/gsoc/tmva/pytorch/torchscript/2020/07/22/Internals-TMVA-PyTorch-Interface</id><content type="html" xml:base="https://anirudhdagar.github.io/gsoc/tmva/pytorch/torchscript/2020/07/22/Internals-TMVA-PyTorch-Interface.html">&lt;p&gt;&lt;img alt=&quot;Can't See? Something went wrong!&quot; src=&quot;/gsoc/images/who-handles-what.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;This post is intended to focus on the internals of the TMVA PyTorch interface and I‚Äôll be discussing the details and design choices made. As can be seen in the figure above, the workforce for various tasks is divided clearly between the two frameworks. We define the model, optimizer, loss criterion and the training/prediction loop within PyTorch. On the other hand TMVA handles all the preprocessing, Dataloading, validation and evaluation.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Tip&lt;/strong&gt;: You may want to refer to the source code for TMVA PyTorch Interface while following this blog.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;declareoptions&quot;&gt;DeclareOptions&lt;/h3&gt;

&lt;p&gt;We provide a few useful options to the user for deciding the necessary and optional arguments. These involve the information required for training a pytorch model.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-C&quot;&gt;void MethodPyTorch::DeclareOptions() {
	/*
	 * fFilenameModel : Filename of the initial PyTorch model&quot;);

	 * fFilenameTrainedModel : Filename of the trained output PyTorch model&quot;);

	 * fBatchSize : Training batch size

	 * fNumEpochs : Number of training epochs

	 * fContinueTraining : Load weights from previous training

	 * fSaveBestOnly : Store only weights with smallest validation loss

	 * fLearningRateSchedule : Set new learning rate at specific epochs
	                           e.g., \&quot;50,0.01;70,0.005\&quot;&quot;

	 * fNumValidationString : Part of the training data to use for validation.&quot;
                    Specify as 0.2 or 20% to use a fifth of the data set as validation set
                    Specify as 100 to use exactly 100 events. (Default: 20%)

	 * fUserCodeName : Necessary python code provided by the user to be executed 
     				   before loading and training the PyTorch Model

	 */
}
&lt;/code&gt;&lt;/pre&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;setuptorchmodel&quot;&gt;SetupTorchModel&lt;/h3&gt;

&lt;p&gt;Here we set-up the pytorch specific code by utilizing the user code from the dictionary &lt;code class=&quot;highlighter-rouge&quot;&gt;load_model_custom_objects&lt;/code&gt; and load the saved model from the &lt;code class=&quot;highlighter-rouge&quot;&gt;.pt&lt;/code&gt; file. We initialize these function objects which will be required later during prediction and training.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-C&quot;&gt;void MethodPyTorch::SetupTorchModel(bool loadTrainedModel) {
	// Load initial model or already trained model
	  
	/* Execute user code 

	* Load pytorch model from file

	* Load pytorch user code function objects
	         * Optimizer
	         * Loss Criterion
	         * Train Method
	         * Predict Method

	* load_model_custom_objects = {&quot;optimizer&quot;: optimizer, &quot;criterion&quot;:
	                criterion, &quot;train_func&quot;: fit, &quot;predict_func&quot;: predict}

	* Initialize variables and weights

	*/
}
&lt;/code&gt;&lt;/pre&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;train&quot;&gt;Train&lt;/h3&gt;

&lt;p&gt;Here we prepare the training process starting with loading the training data into numpy arrays and building the PyTorch Dataloader from these arrays. &lt;code class=&quot;highlighter-rouge&quot;&gt;GetAnalysisType()&lt;/code&gt; provides us with the type of analysis which is used to fill targets.&lt;/p&gt;

&lt;p&gt;For Example:&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;if GetAnalysisType() == Types::kClassification || GetAnalysisType() == Types::kMulticlass&lt;/code&gt;, then, convert class number to one-hot vectors.&lt;/p&gt;

&lt;p&gt;Once the training and validation dataloaders are ready, we proceed towards setting up optional training tricks like the &lt;em&gt;learning rate scheduler&lt;/em&gt; or the option to &lt;em&gt;save best model&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;Now the &lt;code class=&quot;highlighter-rouge&quot;&gt;train_func&lt;/code&gt; defined in the &lt;code class=&quot;highlighter-rouge&quot;&gt;load_model_custom_objects&lt;/code&gt; dictionary is used to invoke the function call and initiate the training process.&lt;/p&gt;

&lt;p&gt;The trained model is returned and is saved if and only if the &lt;em&gt;save best model&lt;/em&gt; option is switched off because we do not want to override the best model checkpoint by saving again.&lt;/p&gt;

&lt;p&gt;Finally, all the memory is freed by deleting the defined data arrays.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-C&quot;&gt; void MethodPyTorch::Train() {
  
	/* Setup parameters

	* Setup Dataloader and conversion to torch DataLoader

	* Setup training callbacks like keras

	* Store trained model to file (only if option 'SaveBestOnly' is NOT activated,
	  as we do not want to override the best model checkpoint)

	* Load PyTorch (torchscript) model from checkpoint .tar file or .pt/.pth file
	  Load initial model or already trained model

	* Start model training

	*/
 
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;These were the 3 main methods required for training a pytorch model leveraging the PyMVA Interface.
Methods to call the &lt;code class=&quot;highlighter-rouge&quot;&gt;predict_func&lt;/code&gt; and carry on evaluation are also implemented within the interface, but for the sake of simplicity we‚Äôll skip them from this post. One can take a look at the source code to get a better understanding of how these work.&lt;/p&gt;</content><author><name></name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://anirudhdagar.github.io/gsoc/images/who-handles-what.png" /><media:content medium="image" url="https://anirudhdagar.github.io/gsoc/images/who-handles-what.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Python C API &amp;amp; PyMVA</title><link href="https://anirudhdagar.github.io/gsoc/c/python/tmva/interface/2020/07/08/PyMVA-Python-C-API.html" rel="alternate" type="text/html" title="Python C API &amp; PyMVA" /><published>2020-07-08T00:00:00-05:00</published><updated>2020-07-08T00:00:00-05:00</updated><id>https://anirudhdagar.github.io/gsoc/c/python/tmva/interface/2020/07/08/PyMVA-Python-C-API</id><content type="html" xml:base="https://anirudhdagar.github.io/gsoc/c/python/tmva/interface/2020/07/08/PyMVA-Python-C-API.html">&lt;p&gt;Using python‚Äôs easy interface is fun!&lt;/p&gt;

&lt;p&gt;&lt;img alt=&quot;Can't See? Something went wrong!&quot; src=&quot;/gsoc/images/python_flying.jpg&quot; /&gt;&lt;/p&gt;

&lt;p&gt;It is as much fun developing the interface for that too! Or is it?&lt;/p&gt;

&lt;p&gt;It‚Äôs often not. It‚Äôs not easy to write efficient and robust modules in python. It‚Äôs easy to see why. While a lot of modules can be implemented in pure python, they often lag in performance. If all you care about is performance from your code, one option is to simply write code in a low level language like C++ and use it in other C++ modules. But, it‚Äôs really painful to go back to doing everything in C++ when your cool machine learning friends are using magical python libraries (I mean PyTorch :p). After using python for a while, you know how simple, powerful, and flexible it is, meeting all your Machine Learning requirements. There is little reason to go back.&lt;/p&gt;

&lt;p&gt;For High Energy Physics, the go-to framework for big data analysis has been CERN‚Äôs ROOT framework. ROOT is a massive C++ library that even predates the STL in some areas. ROOT has a sub-module, TMVA, which houses the machine learning framework specifically developed for HEP data.&lt;/p&gt;

&lt;p&gt;But when you are a Python developer with a C or C++ library, you‚Äôd like to use that from Python too!&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;python-bindings&quot;&gt;Python Bindings&lt;/h2&gt;

&lt;p&gt;Python bindings allow you to call functions and pass data from Python to C or C++, letting you take advantage of the strengths of both languages. Almost all the scientific packages that you may have used in Python are developed in C++. A few examples are Numpy, Pandas, PyTorch. Numpy, for example, achieves a lot of its performance by carefully managing (and reusing) memory, and calling it from Python avoids the garbage collection overheads of writing the same functions in Python.&lt;/p&gt;

&lt;p&gt;There are many slick tools and solutions for developing the python bindings, and if you are interested, I‚Äôd recommend reading &lt;a href=&quot;https://iscinumpy.gitlab.io/post/tools-to-bind-to-python/&quot;&gt;this&lt;/a&gt; awesome blog by &lt;a href=&quot;https://iscinumpy.gitlab.io/page/about/&quot;&gt;Henry Schreiner&lt;/a&gt; explaining various binding tools in detail.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;The Python API is incorporated in a C source file by including the header ‚ÄúPython.h‚Äù.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-C++&quot;&gt;#include &amp;lt;Python.h&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This will import everything needed to extend Python with C. Everything in python is an object and is represented as &lt;code class=&quot;highlighter-rouge&quot;&gt;PyObject&lt;/code&gt; here. That includes everything from &lt;code class=&quot;highlighter-rouge&quot;&gt;int&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;str&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;list&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;dict&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;None&lt;/code&gt; etc.&lt;/p&gt;

&lt;p&gt;All user-visible symbols defined by Python.h have a prefix of &lt;code class=&quot;highlighter-rouge&quot;&gt;Py&lt;/code&gt; or &lt;code class=&quot;highlighter-rouge&quot;&gt;PY&lt;/code&gt;, except those defined in standard header files.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-C++&quot;&gt;Py_Initialize();
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This initializes the python interpreter and is required for everything we do with our TMVA PyTorch Interface.&lt;/p&gt;

&lt;p&gt;If and when a function fails, it should set an exception condition and return an error value (usually a &lt;code class=&quot;highlighter-rouge&quot;&gt;NULL&lt;/code&gt; pointer). Exceptions are stored in a static global variable inside the interpreter; if this variable is &lt;code class=&quot;highlighter-rouge&quot;&gt;NULL&lt;/code&gt; no exception has occurred.&lt;/p&gt;

&lt;p&gt;Anyways in PyMVA we are intrigued with not only making C functions callable from Python, but, the inversion is additionally utilizable.&lt;/p&gt;

&lt;h2 id=&quot;calling-python-functions-from-c&quot;&gt;Calling Python functions from C&lt;/h2&gt;

&lt;p&gt;This is especially the case for the TMVA PyTorch Interface that requires PyTorch based functions from user. Other uses are also imaginable.&lt;/p&gt;

&lt;p&gt;Calling a Python function is relatively easy. First, the Python program must somehow pass you the Python function object. You should provide a function (or some other interface) to do this. It is generally a good practice to check the function object by &lt;code class=&quot;highlighter-rouge&quot;&gt;PyCallable_Check()&lt;/code&gt;. Finally, when the function is called, save a pointer to the Python function object in a global variable ‚Äî or wherever you see fit.&lt;/p&gt;

&lt;p&gt;Later, when it is time to call the function, you call either of the following C functions depending on the use:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://docs.python.org/3/c-api/object.html#c.PyObject_CallObject&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;PyObject_CallObject()&lt;/code&gt;&lt;/a&gt; : Call a callable Python object &lt;em&gt;callable&lt;/em&gt;, with arguments given by the tuple args. If no arguments are needed, then args can be &lt;code class=&quot;highlighter-rouge&quot;&gt;NULL&lt;/code&gt;.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://docs.python.org/3/c-api/object.html#c.PyObject_CallFunction&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;PyObject_CallFunction()&lt;/code&gt;&lt;/a&gt; : Call a callable Python object &lt;em&gt;callable&lt;/em&gt;, with a variable number of C arguments. The C arguments are described using a &lt;a href=&quot;https://docs.python.org/3/c-api/arg.html#c.Py_BuildValue&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Py_BuildValue()&lt;/code&gt;&lt;/a&gt; style format string. The format can be &lt;code class=&quot;highlighter-rouge&quot;&gt;NULL&lt;/code&gt;, indicating that no arguments are provided.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://docs.python.org/3/c-api/object.html#c.PyObject_CallMethod&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;PyObject_CallMethod()&lt;/code&gt;&lt;/a&gt; : Call the method named &lt;em&gt;name&lt;/em&gt; of object obj with a variable number of C arguments. The C arguments are described by a &lt;a href=&quot;https://docs.python.org/3/c-api/arg.html#c.Py_BuildValue&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Py_BuildValue()&lt;/code&gt;&lt;/a&gt; format string that should produce a tuple.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://docs.python.org/3/c-api/object.html#c.PyObject_CallFunctionObjArgs&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;PyObject_CallFunctionObjArgs()&lt;/code&gt;&lt;/a&gt; : Call a callable Python object &lt;em&gt;callable&lt;/em&gt;, with a variable number of &lt;code class=&quot;highlighter-rouge&quot;&gt;PyObject*&lt;/code&gt; arguments. The arguments are provided as a variable number of parameters followed by &lt;code class=&quot;highlighter-rouge&quot;&gt;NULL&lt;/code&gt;.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://docs.python.org/3/c-api/object.html#c.PyObject_CallMethodObjArgs&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;PyObject_CallMethodObjArgs()&lt;/code&gt;&lt;/a&gt; : Calls a method of the Python object &lt;em&gt;obj&lt;/em&gt;, where the name of the method is given as a Python string object in name. It is called with a variable number of &lt;code class=&quot;highlighter-rouge&quot;&gt;PyObject*&lt;/code&gt; arguments. The arguments are provided as a variable number of parameters followed by &lt;code class=&quot;highlighter-rouge&quot;&gt;NULL&lt;/code&gt;.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;These functions on execution return a Python object pointer, this is the return value of the Python function.&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;root-pymva&quot;&gt;ROOT PyMVA&lt;/h2&gt;

&lt;p&gt;&lt;img alt=&quot;Can't See? Something went wrong!&quot; src=&quot;/gsoc/images/PyMVA_Data_Flow.png&quot; align=&quot;right&quot; width=&quot;60%&quot; /&gt;&lt;/p&gt;

&lt;p&gt;PyMVA is a set of plugins for TMVA package based on Python that consists a set of classes that engage TMVA and allows new methods of classification and regression using external frameworks and modules.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;PyMethodBase&lt;/code&gt; is the virtual base class for all PyMVA methods. It handles initialization of python interpreter, serialization, deserialization and has utilities for executing Python code in TMVA leveraging the C API for python discussed above.
&lt;code class=&quot;highlighter-rouge&quot;&gt;PyMethodBase&lt;/code&gt; is the backbone for all PyMVA methods. Our PyTorch Interface in TMVA (under development) is built on top of &lt;strong&gt;PyMVA&lt;/strong&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;PyMethodBase&lt;/code&gt; particularly!&lt;/p&gt;</content><author><name></name></author><summary type="html">Using python‚Äôs easy interface is fun!</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://www.python.org/static/img/python-logo@2x.png" /><media:content medium="image" url="https://www.python.org/static/img/python-logo@2x.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Phase 1 Evaluation</title><link href="https://anirudhdagar.github.io/gsoc/coding/evaluation/gsoc/2020/07/03/Phase-1-Ends.html" rel="alternate" type="text/html" title="Phase 1 Evaluation" /><published>2020-07-03T00:00:00-05:00</published><updated>2020-07-03T00:00:00-05:00</updated><id>https://anirudhdagar.github.io/gsoc/coding/evaluation/gsoc/2020/07/03/Phase-1-Ends</id><content type="html" xml:base="https://anirudhdagar.github.io/gsoc/coding/evaluation/gsoc/2020/07/03/Phase-1-Ends.html">&lt;h1 id=&quot;progress&quot;&gt;Progress&lt;/h1&gt;

&lt;p&gt;This is a short update on my progress till the Phase 1 Evaluations in GSoC 2020. The following goals were set for the 1st month according to my proposal, of which I was able to complete the following.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Header MethodPyTorch&lt;/strong&gt;&lt;/p&gt;
&lt;ul class=&quot;task-list&quot;&gt;
  &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Add Initial Structure for &lt;code class=&quot;highlighter-rouge&quot;&gt;MethodPyTorch.h&lt;/code&gt; header file.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;Class MethodPyTorch&lt;/strong&gt;
Implement the basic outline of &lt;code class=&quot;highlighter-rouge&quot;&gt;MethodPyTorch.cxx&lt;/code&gt; Class.&lt;/p&gt;

&lt;ul class=&quot;task-list&quot;&gt;
  &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Implement the &lt;code class=&quot;highlighter-rouge&quot;&gt;DeclareOptions&lt;/code&gt; method&lt;/li&gt;
  &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Implement &lt;code class=&quot;highlighter-rouge&quot;&gt;ProcessOptions&lt;/code&gt; method&lt;/li&gt;
  &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Implement &lt;code class=&quot;highlighter-rouge&quot;&gt;SetupTorchModel&lt;/code&gt; method&lt;/li&gt;
  &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Implement Validation Sample Splits&lt;/li&gt;
  &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; /&gt;Implement train methods. (Could not complete)
    &lt;ul class=&quot;task-list&quot;&gt;
      &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Implement simple basic structure for training&lt;/li&gt;
      &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; /&gt;Add ability to load code from users&lt;/li&gt;
      &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Convert numpy based dataloaders in TMVA to PyTorch dataloaders&lt;/li&gt;
      &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; /&gt;Use default optimizer (optional optimizer SGD)&lt;/li&gt;
      &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; /&gt;Add savebest model&lt;/li&gt;
      &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; /&gt;Add scheduler&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; checked=&quot;checked&quot; /&gt;Implement &lt;code class=&quot;highlighter-rouge&quot;&gt;helper&lt;/code&gt; function&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The &lt;code class=&quot;highlighter-rouge&quot;&gt;train&lt;/code&gt; method in the &lt;code class=&quot;highlighter-rouge&quot;&gt;MethodPyTorch&lt;/code&gt; requires a few more preliminary options which will facilitate loading user code into the TMVA Interface, but it‚Äôs not implemented in PyMVA yet. Lorenzo (my mentor) is working on a solution for that exact problem and as soon as that is fixed, I should be able to implement the train method.&lt;/p&gt;

&lt;p&gt;Hopefully, I‚Äôll get this done in the next couple of weeks!ü§û&lt;/p&gt;</content><author><name></name></author><summary type="html">Progress</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://anirudhdagar.github.io/gsoc/images/first_eval.jpg" /><media:content medium="image" url="https://anirudhdagar.github.io/gsoc/images/first_eval.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">PyTorch &amp;amp; TorchScript</title><link href="https://anirudhdagar.github.io/gsoc/tmva/pytorch/torchscript/2020/06/17/PyTorch-and-TorchScript.html" rel="alternate" type="text/html" title="PyTorch &amp; TorchScript" /><published>2020-06-17T00:00:00-05:00</published><updated>2020-06-17T00:00:00-05:00</updated><id>https://anirudhdagar.github.io/gsoc/tmva/pytorch/torchscript/2020/06/17/PyTorch-and-TorchScript</id><content type="html" xml:base="https://anirudhdagar.github.io/gsoc/tmva/pytorch/torchscript/2020/06/17/PyTorch-and-TorchScript.html">&lt;p&gt;Though there are numerous tutorials on PyTorch out there, I wanted to compose a little post for individuals who may wind up utilizing the TMVA PyTorch Interface. I also want to draw some contrasts, defining distinctions between Keras and PyTorch interfaces in TMVA.&lt;/p&gt;

&lt;p&gt;PyTorch is a Python-based scientific package supporting a‚Äãutomatic differentiation.‚Äã An ‚Äãopen-source machine learning‚Äã framework that accelerates the path from research prototyping to production deployment. ‚ÄãA research platform that provides maximum flexibility‚Äã and s‚Äãpeed.&lt;/p&gt;

&lt;p&gt;&lt;img alt=&quot;Can't See? Something went wrong!&quot; src=&quot;/gsoc/images/Keras-or-PyTorch.png&quot; width=&quot;80%&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Both the frameworks are really useful in their own myriad ways. For your daily machine learning models, you can achieve similar results with either of the two.&lt;/p&gt;

&lt;p&gt;Keras shines especially with it‚Äôs simple high-level tensorflow API. It may be easier to get into and experiment with standard layers. If your work involves some elementary experiments, Keras maybe the goto framework due to its plug &amp;amp; play spirit.&lt;/p&gt;

&lt;p&gt;But things get interesting when one requires low level control and flexibility. That‚Äôs when the argument for Keras starts losing water. PyTorch on the other hand is amazing in terms of control, flexibility and raw power that it can provide to the user. It‚Äôs lower-level approach is better suited for the more mathematically-inclined users.&lt;/p&gt;

&lt;p&gt;PyTorch is widely used‚Äã among researchers and hence has a large community around it continuously improving the framework with state of the art developements.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Need for PyTorch Interface?&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;‚óè &lt;strong&gt;ROOT + PyTorch&lt;/strong&gt;: Allows to integrate ROOT methods which are good at handling HEP data and PyTorch which can be useful for Machine Learning.&lt;/p&gt;

&lt;p&gt;‚óè &lt;strong&gt;Power &amp;amp; Flexibility&lt;/strong&gt;: ‚ÄãNot easy to develop using TMVA, as they require complex configuration strings. Even with PyKeras Interface, designing custom layers is not feasible. PyTorch offers the power and flexibility to achieve complex models with custom layers, optimizers, loss functions and training methodologies.&lt;/p&gt;

&lt;p&gt;‚óè &lt;strong&gt;Ease of Debugging&lt;/strong&gt;: ‚ÄãPyTorch models make use of dynamic computation graphs and are based on eager execution. This makes it easier to use debugging tools like pdb.&lt;/p&gt;

&lt;p&gt;‚óè &lt;strong&gt;Performance&lt;/strong&gt;: PyTorch performs much better than Keras due to it‚Äôs highly optimized C++ backend.&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;defining-models-in-pytorch&quot;&gt;Defining Models in PyTorch&lt;/h3&gt;

&lt;p&gt;Below I‚Äôve shared a few options which can be employed to define models in PyTorch based on the requirement. As mentioned earlier the customisations possible here are only limited by our imaginations.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Implemented using the torch.nn.Module
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;‚Äã&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;TwoLayerNet&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;‚Äã&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;‚Äã&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;‚Äã&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;D_in&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;H&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;D_out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
	&lt;span class=&quot;err&quot;&gt;‚Äã&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&quot;&quot;
	In the constructor we instantiate two nn.Linear
	modules and assign them as member variables.
	&quot;&quot;&quot;&lt;/span&gt;
	&lt;span class=&quot;nb&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TwoLayerNet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
	&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;linear1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Linear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;D_in&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;H&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;linear2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Linear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;H&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;D_out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

	&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;‚Äã&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;forward&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;‚Äã&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
	&lt;span class=&quot;err&quot;&gt;‚Äã&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&quot;&quot;
	In the forward function we accept a tensor of input data
	and we must return a tensor of output data. We can use
	modules defined in the constructor as well as arbitrary
	operators on tensors.
	&quot;&quot;&quot;&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;h_relu&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;linear1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clamp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;‚Äã&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;‚Äã&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;linear2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;h_relu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	
	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;


&lt;span class=&quot;c1&quot;&gt;# N is batch size; D_in is input dimension;
# H is hidden dimension; D_out is output dimension.
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;D_in&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;H&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;D_out&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;


&lt;span class=&quot;c1&quot;&gt;# Construct our model by instantiating the class defined above
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TwoLayerNet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;D_in&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;H&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;D_out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;##########
# OR
##########
&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Similar to Keras
# Implemented using the torch.nn.Sequential Module
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Sequqntial&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Linear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;D_in&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;H&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ReLU&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Linear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;H&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;D_out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;##########
# OR
##########
&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# One can choose to implement using ModuleList/ModuleDict
# See the PyTorch Documentation for more details on containers.
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;To develop our interface we need the ability to store a defined model into a file which can be later loaded into the TMVA C++ backend when Booking and Training the models.&lt;/p&gt;

&lt;p&gt;While &lt;code class=&quot;highlighter-rouge&quot;&gt;model.save()&lt;/code&gt; in keras saves the whole model in &lt;code class=&quot;highlighter-rouge&quot;&gt;.hdf5&lt;/code&gt; file along with other information, in PyTorch, one can achieve similar functionality using &lt;code class=&quot;highlighter-rouge&quot;&gt;torch.save()&lt;/code&gt;. The issue here is that before we load back the model into memory from the saved file, it requires you to define the model class again. &lt;code class=&quot;highlighter-rouge&quot;&gt;torch.save&lt;/code&gt; inputs a dictionary to save only the model parameters and other learnable parameters (optimizers state etc.) or variables like &lt;code class=&quot;highlighter-rouge&quot;&gt;current_epoch&lt;/code&gt;. Though that is neat, we require our model to be completely stored in a file which can be used later without any knowledge of model definition.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Enter torchscript!&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;TorchScript is a method to create serializable and optimizable models from PyTorch code. Any TorchScript program can be saved from a Python process and loaded in a process where there is no Python dependency.&lt;/p&gt;

&lt;p&gt;PyTorch provides tools to incrementally transition a model from a pure Python program to a TorchScript program that can be run independently from Python, such as in a standalone C++ program. This makes it possible to train models in PyTorch using familiar tools in Python and then export the model via TorchScript to a different environment where Python programs may be disadvantageous.&lt;/p&gt;

&lt;p&gt;Through torchscript, we can serialize and save the model which can be later loaded into the TMVA C++ backend from a stand-alone &lt;code class=&quot;highlighter-rouge&quot;&gt;.pt&lt;/code&gt; file.&lt;/p&gt;

&lt;p&gt;There will be a more detailed post discussing the details of the internals and design choices made for the TMVA PyTorch Interface.&lt;/p&gt;

&lt;p&gt;Bbye for now!&lt;/p&gt;</content><author><name></name></author><summary type="html">Though there are numerous tutorials on PyTorch out there, I wanted to compose a little post for individuals who may wind up utilizing the TMVA PyTorch Interface. I also want to draw some contrasts, defining distinctions between Keras and PyTorch interfaces in TMVA.</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://anirudhdagar.github.io/gsoc/images/PyTorch.jpg" /><media:content medium="image" url="https://anirudhdagar.github.io/gsoc/images/PyTorch.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Coding Officially Starts!</title><link href="https://anirudhdagar.github.io/gsoc/coding/communication/2020/06/01/Coding-Starts.html" rel="alternate" type="text/html" title="Coding Officially Starts!" /><published>2020-06-01T00:00:00-05:00</published><updated>2020-06-01T00:00:00-05:00</updated><id>https://anirudhdagar.github.io/gsoc/coding/communication/2020/06/01/Coding-Starts</id><content type="html" xml:base="https://anirudhdagar.github.io/gsoc/coding/communication/2020/06/01/Coding-Starts.html">&lt;h3 id=&quot;updates&quot;&gt;Updates&lt;/h3&gt;

&lt;p&gt;The community bonding period ends today. During this time, we established a working and communication strategy with the mentors. TMVA developers have &lt;a href=&quot;https://mattermost.com/&quot;&gt;Mattermost&lt;/a&gt;, an open-source, self-hostable online chat and communication service, similar to slack. A meeting will be organized every Friday for discussing the progress and doubts with the mentors throughout the program. Thanks to Omar, who provided me access to a GPU enabled server required for testing the interface.&lt;/p&gt;

&lt;p&gt;There was a welcome meeting organized by the CERN-HSF GSoC team, lead by the admin, Dr. Andrei Gheata. The admins provided some insight on the past programs, and the experience they have had with GSoC students earlier. He adviced us to comply with the rules as members of the CERN community stringently. We had a small discussion about the milestones in the coding period and how one should approach the coming phases in the program.&lt;/p&gt;

&lt;p&gt;I also managed to connect with Stefan Wunsch (ROOT contributor) who developed the PyKeras interface in TMVA-ROOT. His help and suggestions can prove to be valuable, since we plan to create a PyKeras like interface, but for PyTorch.&lt;/p&gt;

&lt;h3 id=&quot;building-root-for-development&quot;&gt;Building ROOT for Development&lt;/h3&gt;

&lt;p&gt;Coming to the development based issues, one common problem with &lt;strong&gt;ROOT&lt;/strong&gt; is that it is &lt;strong&gt;arduous to install&lt;/strong&gt; ‚Äì if you build from source, it‚Äôs a several hour task on a single core (clean build on my local machine with 4 cores at 8 threads took more than 2 hrs). It has gotten much better in the past few years, but there‚Äôs still scope for improvement. This is &lt;strong&gt;especially true for Python&lt;/strong&gt;; ROOT is linked to your distro‚Äôs Python as of ROOT 6.22; but the common rule for using Python is ‚Äúdon‚Äôt touch your system Python‚Äù - hence modern Python users should be in a virtual environment, and for that ROOT requires the system site-packages option be enabled, which is not always ideal.&lt;/p&gt;

&lt;p&gt;Like every other machine learning person, you can use the &lt;strong&gt;Anaconda Python distribution&lt;/strong&gt;, which is the most popular scientific distribution of Python and massively successful for environment management.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;But, the general rule even for people who build ROOT themselves has been: DON‚ÄôT&lt;/strong&gt;.&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# Note: Ensure that all conda environments are deactivated.&lt;/span&gt;
git clone https://github.com/root-project/root.git
&lt;span class=&quot;nb&quot;&gt;mkdir &lt;/span&gt;build_root install_root &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;build_root

&lt;span class=&quot;c&quot;&gt;# Standard&lt;/span&gt;
cmake &lt;span class=&quot;nt&quot;&gt;-DCMAKE_INSTALL_PREFIX&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;../install_root ../root
&lt;span class=&quot;c&quot;&gt;# OR&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Faster Build with limited options&lt;/span&gt;
cmake &lt;span class=&quot;nt&quot;&gt;-DCMAKE_INSTALL_PREFIX&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;../install_root &lt;span class=&quot;nt&quot;&gt;-Droofit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;OFF &lt;span class=&quot;nt&quot;&gt;-Dccache&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;ON ../root

&lt;span class=&quot;c&quot;&gt;# If you have n=4 cores available for compilation&lt;/span&gt;
cmake &lt;span class=&quot;nt&quot;&gt;--build&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-j4&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;source&lt;/span&gt; ../install_root/bin/thisroot.sh 

&lt;span class=&quot;c&quot;&gt;# Setup an alias for activating root.&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;alias &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;thisroot&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'source /Users/gollum/Desktop/Work/gsoc/install_root/bin/thisroot.sh'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;figcaption&gt;&lt;b&gt;&lt;center&gt;Steps to get up &amp;amp; runnning!&lt;/center&gt;&lt;/b&gt;&lt;/figcaption&gt;

&lt;p&gt;One may disable parts of root that you don‚Äôt need, e.g., &lt;code class=&quot;highlighter-rouge&quot;&gt;roofit&lt;/code&gt;, just add the &lt;code class=&quot;highlighter-rouge&quot;&gt;-Droofit=OFF&lt;/code&gt; flag to cmake.
Some other tricks to improve the build cycle is to use ccache and call the build with &lt;code class=&quot;highlighter-rouge&quot;&gt;cmake /path/to/source -Dccache=ON&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Although the build takes about 2 hours or so for the first time, the incremental builds are generally much much faster. This is because, by default cmake rebuilds only what is required and a clean build is not triggered everytime changes are made.&lt;/p&gt;

&lt;p&gt;&lt;img alt=&quot;Can't See? Something went wrong!&quot; src=&quot;/gsoc/images/cling.jpg&quot; /&gt;&lt;/p&gt;
&lt;figcaption&gt;&lt;b&gt;&lt;center&gt;Working with ROOT CLING&lt;/center&gt;&lt;/b&gt;&lt;/figcaption&gt;

&lt;h3 id=&quot;wip-pr&quot;&gt;WIP PR&lt;/h3&gt;

&lt;p&gt;I started coding in the community bonding period to get a head start. I‚Äôve implemented &lt;code class=&quot;highlighter-rouge&quot;&gt;MethodPyTorch.h&lt;/code&gt; header which contains macro definitions and method declarations to be shared between the source files and invoked later. Also I‚Äôve set-up structure of the project with &lt;code class=&quot;highlighter-rouge&quot;&gt;cmake&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;A Draft Pull Request marking the start of the official coding period and to track the progress is now available &lt;a href=&quot;https://github.com/root-project/root/pull/5757&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/root-project/root/pull/5757&quot;&gt;
&lt;img alt=&quot;Can't See? Something went wrong!&quot; src=&quot;/gsoc/images/baby_pr.jpg&quot; width=&quot;60%&quot; /&gt;
&lt;/a&gt;
&lt;br /&gt;
Although for now the PR is genuinely in the baby stage and a plethora of things are to be implemented afore some genuine feedback can be provided, feel free at any time for any kind of suggestions and comments. It would be extremely helpful and I‚Äôll endeavor my best to incorporate the suggested improvements.&lt;/p&gt;</content><author><name></name></author><summary type="html">Updates</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://anirudhdagar.github.io/gsoc/images/code.png" /><media:content medium="image" url="https://anirudhdagar.github.io/gsoc/images/code.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">I am in</title><link href="https://anirudhdagar.github.io/gsoc/about/motivation/markdown/2020/05/07/post1-i-am-in.html" rel="alternate" type="text/html" title="I am in" /><published>2020-05-07T00:00:00-05:00</published><updated>2020-05-07T00:00:00-05:00</updated><id>https://anirudhdagar.github.io/gsoc/about/motivation/markdown/2020/05/07/post1-i-am-in</id><content type="html" xml:base="https://anirudhdagar.github.io/gsoc/about/motivation/markdown/2020/05/07/post1-i-am-in.html">&lt;h2 id=&quot;journey-to-selection-day&quot;&gt;Journey to Selection Day&lt;/h2&gt;

&lt;p&gt;Hi everyone, I am glad to inform that I have been selected as a student developer in Google Summer of Code 2020 at CERN-HSF. I am really excited about contributing and working on the project &lt;a href=&quot;https://hepsoftwarefoundation.org/gsoc/2020/proposal_TMVAPyTorch.html&quot;&gt;‚ÄúTMVA Interfaces PyTorch‚Äù&lt;/a&gt;.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;&lt;font color=&quot;#1756a9&quot;&gt;tl;dr&lt;/font&gt;&lt;/strong&gt; : My project involves creating a PyTorch interface on top of the TMVA PyMVA framework for making PyTorch-like model definitions possible. In essence the idea is: PyTorch provides model definition, training and prediction but TMVA does the preprocessing, dataloading, testing etc.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;a href=&quot;https://summerofcode.withgoogle.com/projects/#5720405488173056&quot;&gt;
&lt;img alt=&quot;Can't See? Something went wrong!&quot; src=&quot;/gsoc/images/gsoc_accept.jpg&quot; /&gt;
&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I applied to GSoC for the first time. It was such a delight seeing this in my mail, and I hope I can do justice to the project, achieving the desired goals.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/gsoc/images/gsoc_accept_mail.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;My project is co-mentored by &lt;a href=&quot;https://www.linkedin.com/in/lorenzo-moneta-982b902/&quot;&gt;Lorenzo Moneta&lt;/a&gt;, &lt;a href=&quot;https://www.linkedin.com/in/akshay-vashistha-9a558778/&quot;&gt;Akshay Vashishtha&lt;/a&gt; and &lt;a href=&quot;https://www.linkedin.com/in/omar-andres-zapata-mesa-4ab16a5b/&quot;&gt;Omar Andres Zapata Mesa&lt;/a&gt; from the following organizations:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://hepsoftwarefoundation.org/&quot;&gt;HEP Software Foundation&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://oproject.org/&quot;&gt;OProject&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.kit.edu/english/&quot;&gt;Karlsruhe Institute of Technology (KIT)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;motivation&quot;&gt;Motivation&lt;/h2&gt;

&lt;p&gt;Google Summer of Code (GSoC) is a program that matches mentoring organizations with college and university student developers, who work on open source development throughout the summers. Each year, Google works with many open source, free software, and technology-related groups to identify and fund proposals for student open source projects. GSoC pairs accepted student applicants with mentors from participating projects.&lt;/p&gt;

&lt;p&gt;I :heart: open source. For the past year, I have been actively involved in various open-source projects &lt;a href=&quot;https://github.com/anirudhdagar&quot;&gt;(See GitHub)&lt;/a&gt;. As a GSoC applicant my aim was to contribute to OSS orgs and gain exposure to real-world software development.&lt;/p&gt;

&lt;p&gt;Making an impact and contributing to the software used and developed by one of the world‚Äôs &lt;strong&gt;largest&lt;/strong&gt; and most &lt;strong&gt;respected&lt;/strong&gt; scientific research centres, &lt;strong&gt;CERN&lt;/strong&gt;, was the key driving force along with my inclination and skills in &lt;strong&gt;Machine Learning, Research and Open Source.&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;about-organization&quot;&gt;About Organization&lt;/h2&gt;

&lt;p&gt;CERN-HSF (High-Energy Physics Software Foundation) is the umbrella organization for high-energy physics-related projects in GSoC. The HEP Software Foundation facilitates the coordination of common international efforts in high-energy physics software and computing.&lt;/p&gt;

&lt;p&gt;TMVA is a submodule of ROOT Project (One of the famous projects by CERN). ROOT is a modular scientific software framework. It provides all the functionalities needed to deal with big data processing, statistical analysis, visualisation, and storage. It is mainly written in C++ but integrated with other languages such as Python and R. The Toolkit for Multivariate Data Analysis with ROOT (TMVA) is a standalone project that provides a ROOT-integrated machine learning environment for the processing and parallel evaluation of sophisticated multivariate classification techniques.&lt;/p&gt;

&lt;h2 id=&quot;experience-applying-to-gsoc&quot;&gt;Experience Applying to GSoC&lt;/h2&gt;

&lt;p&gt;If I had to summarize in a few words, &lt;strong&gt;it was pretty fun!&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;So, I stumbled upon this project on &lt;strong&gt;&lt;a href=&quot;https://hepsoftwarefoundation.org/gsoc/2020/proposal_TMVAGraph.html&quot;&gt;‚ÄúTMVA Graph Neural Networks‚Äù&lt;/a&gt;&lt;/strong&gt;, and I was immediately interested due to my recent work and background in &lt;strong&gt;graph representation learning&lt;/strong&gt;. I was upto date with the literature in this field and had carried out a thorough literature survey in the past couple of years. I already knew a bit about ROOT and CERN-HSF and had skimmed over the codebase on github a while back.&lt;/p&gt;

&lt;p&gt;I started with completing the tasks and later focused on my &lt;strong&gt;&lt;a href=&quot;https://drive.google.com/open?id=1Df22pHUzj1rSh06I3CH2EFEsJcBshLCO5mg1aTHR8pQ&quot;&gt;proposal&lt;/a&gt;&lt;/strong&gt; for this idea. I would like to thank my friend &lt;a href=&quot;https://github.com/AaradhyaSaxena&quot;&gt;Aaradhya Saxena&lt;/a&gt; who helped me and reviewed my proposal along the way. It wouldn‚Äôt have been possible without him.&lt;/p&gt;

&lt;p&gt;After reviewing my submission, the mentors were very impressed with my work and mentioned their interest in working with me and fruition. &lt;strong&gt;But&lt;/strong&gt;, they also encouraged me to apply to other projects in TMVA based on my interests. One of the mentors &lt;strong&gt;emphasized&lt;/strong&gt;, that the idea on &lt;strong&gt;&lt;a href=&quot;https://hepsoftwarefoundation.org/gsoc/2020/proposal_TMVAPyTorch.html&quot;&gt;‚ÄúTMVA Interfaces PyTorch‚Äù&lt;/a&gt;&lt;/strong&gt; was a high impact project and I could eventually better &lt;strong&gt;serve particle physicists working on Machine Learning at CERN&lt;/strong&gt;, by leading this new direction for the development of TMVA.&lt;/p&gt;

&lt;p&gt;I took my time to cerebrate and decided to read about this other idea in detail to be certain about my interests. Driven by the impact I could make at CERN through this project, I started working on my &lt;strong&gt;&lt;a href=&quot;https://drive.google.com/open?id=1b54yrngOjth9wUiS7iAg_rEm7J2J749d&quot;&gt;second proposal&lt;/a&gt;&lt;/strong&gt;. After a few sleepless nights, understanding the codebase for this part of the project, I finally submitted the proposal minutes before the deadline. I then completed the tasks for this project in the next couple of days.&lt;/p&gt;

&lt;p&gt;I felt confident about both proposals and was slightly inclined to the GNNs project but I was happy in the end when the projects were announced and &lt;strong&gt;‚ÄúI Got In‚Äù&lt;/strong&gt; with my second proposal. I still plan on contributing to the GNNs project and will endeavor to collaborate with the other GSoC student, &lt;a href=&quot;https://github.com/stlukyanenko&quot;&gt;Stanislav Lukyanenko&lt;/a&gt; on this project.&lt;/p&gt;

&lt;h2 id=&quot;start-of-community-bonding-period&quot;&gt;Start of Community Bonding Period&lt;/h2&gt;

&lt;p&gt;The first phase of the &lt;a href=&quot;https://summerofcode.withgoogle.com/how-it-works/#timeline&quot;&gt;program timeline&lt;/a&gt; for selected students is the community bonding period which started on May 4th. In this period, students familiarise themselves with the organisation‚Äôs community, understand the codebase, contact their mentors, and decide their preferred modes of communication.&lt;/p&gt;

&lt;p&gt;We decided to schedule an introductory meet on 8th May. This, first of many Zoom/Skype meetings will set the stage for the project and the agenda is to meet other TMVA developers and GSoC students who will be presenting and explaining their proposals.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;I‚Äôll try to keep the space spiced up and explainable by sharing code snippets along my journey in the coming months like below:&lt;/p&gt;

&lt;p&gt;Python code and output&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# Say hi to open-source
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Hello Open-Source World!&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Formatting text as shell commands:&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;TMVA Developers are awesome!&quot;&lt;/span&gt;
./gsoc_script.sh &lt;span class=&quot;nt&quot;&gt;--option&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;start&quot;&lt;/span&gt;
wget https://home.cern/community_bonding_period.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;

&lt;p&gt;I hope that this summer will be interesting, challenging and productive.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;To me GSoC is all about communicating, learning and making an impact, for the love of open-source. :heart:&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Stay tuned for my next post! I‚Äôll try to make the blogs interpretable and interactive while documenting and explaining all my experiences and learnings in these coming days.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;See you on the other side!&lt;/p&gt;

&lt;p&gt;Signing Off.&lt;/p&gt;</content><author><name></name></author><summary type="html">Journey to Selection Day</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://anirudhdagar.github.io/gsoc/images/gsoc_accept.jpg" /><media:content medium="image" url="https://anirudhdagar.github.io/gsoc/images/gsoc_accept.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Fastpages Notebook Blog Post</title><link href="https://anirudhdagar.github.io/gsoc/jupyter/2020/02/20/test/" rel="alternate" type="text/html" title="Fastpages Notebook Blog Post" /><published>2020-02-20T00:00:00-06:00</published><updated>2020-02-20T00:00:00-06:00</updated><id>https://anirudhdagar.github.io/gsoc/jupyter/2020/02/20/test</id><content type="html" xml:base="https://anirudhdagar.github.io/gsoc/jupyter/2020/02/20/test/">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-02-20-test.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;About&quot;&gt;About&lt;a class=&quot;anchor-link&quot; href=&quot;#About&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;This notebook is a demonstration of some of capabilities of &lt;a href=&quot;https://github.com/fastai/fastpages&quot;&gt;fastpages&lt;/a&gt; with notebooks.&lt;/p&gt;
&lt;p&gt;With &lt;code&gt;fastpages&lt;/code&gt; you can save your jupyter notebooks into the &lt;code&gt;_notebooks&lt;/code&gt; folder at the root of your repository, and they will be automatically be converted to Jekyll compliant blog posts!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Front-Matter&quot;&gt;Front Matter&lt;a class=&quot;anchor-link&quot; href=&quot;#Front-Matter&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;The first cell in your Jupyter Notebook or markdown blog post contains front matter. Front matter is metadata that can turn on/off options in your Notebook. It is formatted like this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# &quot;My Title&quot;
&amp;gt; &quot;Awesome summary&quot;

- toc:true- branch: master- badges: true- comments: true
- author: Hamel Husain &amp;amp; Jeremy Howard
- categories: [fastpages, jupyter]&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;Setting &lt;code&gt;toc: true&lt;/code&gt; will automatically generate a table of contents&lt;/li&gt;
&lt;li&gt;Setting &lt;code&gt;badges: true&lt;/code&gt; will automatically include GitHub and Google Colab links to your notebook.&lt;/li&gt;
&lt;li&gt;Setting &lt;code&gt;comments: true&lt;/code&gt; will enable commenting on your blog post, powered by &lt;a href=&quot;https://github.com/utterance/utterances&quot;&gt;utterances&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The title and description need to be enclosed in double quotes only if they include special characters such as a colon. More details and options for front matter can be viewed on the &lt;a href=&quot;https://github.com/fastai/fastpages#front-matter-related-options&quot;&gt;front matter section&lt;/a&gt; of the README.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Markdown-Shortcuts&quot;&gt;Markdown Shortcuts&lt;a class=&quot;anchor-link&quot; href=&quot;#Markdown-Shortcuts&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;A &lt;code&gt;#hide&lt;/code&gt; comment at the top of any code cell will hide &lt;strong&gt;both the input and output&lt;/strong&gt; of that cell in your blog post.&lt;/p&gt;
&lt;p&gt;A &lt;code&gt;#hide_input&lt;/code&gt; comment at the top of any code cell will &lt;strong&gt;only hide the input&lt;/strong&gt; of that cell.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;The comment #hide_input was used to hide the code that produced this.
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;put a &lt;code&gt;#collapse-hide&lt;/code&gt; flag at the top of any cell if you want to &lt;strong&gt;hide&lt;/strong&gt; that cell by default, but give the reader the option to show it:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-hide&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandas&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pd&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;altair&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;alt&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;put a &lt;code&gt;#collapse-show&lt;/code&gt; flag at the top of any cell if you want to &lt;strong&gt;show&lt;/strong&gt; that cell by default, but give the reader the option to hide it:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cars&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;https://vega.github.io/vega-datasets/data/cars.json&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;movies&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;https://vega.github.io/vega-datasets/data/movies.json&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sp500&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;https://vega.github.io/vega-datasets/data/sp500.csv&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;stocks&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;https://vega.github.io/vega-datasets/data/stocks.csv&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flights&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;https://vega.github.io/vega-datasets/data/flights-5k.json&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Interactive-Charts-With-Altair&quot;&gt;Interactive Charts With Altair&lt;a class=&quot;anchor-link&quot; href=&quot;#Interactive-Charts-With-Altair&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Charts made with Altair remain interactive.  Example charts taken from &lt;a href=&quot;https://github.com/uwdata/visualization-curriculum&quot;&gt;this repo&lt;/a&gt;, specifically &lt;a href=&quot;https://github.com/uwdata/visualization-curriculum/blob/master/altair_interaction.ipynb&quot;&gt;this notebook&lt;/a&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Example-1:-DropDown&quot;&gt;Example 1: DropDown&lt;a class=&quot;anchor-link&quot; href=&quot;#Example-1:-DropDown&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# single-value selection over [Major_Genre, MPAA_Rating] pairs&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# use specific hard-wired values as the initial selected values&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;selection&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;selection_single&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Select&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;fields&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Major_Genre&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;MPAA_Rating&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Major_Genre&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Drama&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;MPAA_Rating&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;R&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;bind&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Major_Genre&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;binding_select&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;genres&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;MPAA_Rating&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;binding_radio&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mpaa&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  
&lt;span class=&quot;c1&quot;&gt;# scatter plot, modify opacity based on selection&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Chart&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mark_circle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_selection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;selection&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Rotten_Tomatoes_Rating:Q&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;IMDB_Rating:Q&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tooltip&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Title:N&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;opacity&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;condition&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;selection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.75&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.05&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;

&lt;div id=&quot;altair-viz-1a49e83878ce4d678d7b162f3d6b510f&quot;&gt;&lt;/div&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
  (function(spec, embedOpt){
    const outputDiv = document.getElementById(&quot;altair-viz-1a49e83878ce4d678d7b162f3d6b510f&quot;);
    const paths = {
      &quot;vega&quot;: &quot;https://cdn.jsdelivr.net/npm//vega@5?noext&quot;,
      &quot;vega-lib&quot;: &quot;https://cdn.jsdelivr.net/npm//vega-lib?noext&quot;,
      &quot;vega-lite&quot;: &quot;https://cdn.jsdelivr.net/npm//vega-lite@4.0.2?noext&quot;,
      &quot;vega-embed&quot;: &quot;https://cdn.jsdelivr.net/npm//vega-embed@6?noext&quot;,
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () =&gt; resolve(paths[lib]);
        s.onerror = () =&gt; reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName(&quot;head&quot;)[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `&lt;div class=&quot;error&quot; style=&quot;color:red;&quot;&gt;${err}&lt;/div&gt;`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err =&gt; showError(`Javascript Error: ${err.message}&lt;br&gt;This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === &quot;function&quot; &amp;&amp; define.amd) {
      requirejs.config({paths});
      require([&quot;vega-embed&quot;], displayChart, err =&gt; showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === &quot;function&quot;) {
      displayChart(vegaEmbed);
    } else {
      loadScript(&quot;vega&quot;)
        .then(() =&gt; loadScript(&quot;vega-lite&quot;))
        .then(() =&gt; loadScript(&quot;vega-embed&quot;))
        .catch(showError)
        .then(() =&gt; displayChart(vegaEmbed));
    }
  })({&quot;config&quot;: {&quot;view&quot;: {&quot;continuousWidth&quot;: 400, &quot;continuousHeight&quot;: 300}}, &quot;data&quot;: {&quot;url&quot;: &quot;https://vega.github.io/vega-datasets/data/movies.json&quot;}, &quot;mark&quot;: &quot;circle&quot;, &quot;encoding&quot;: {&quot;opacity&quot;: {&quot;condition&quot;: {&quot;value&quot;: 0.75, &quot;selection&quot;: &quot;Select&quot;}, &quot;value&quot;: 0.05}, &quot;tooltip&quot;: {&quot;type&quot;: &quot;nominal&quot;, &quot;field&quot;: &quot;Title&quot;}, &quot;x&quot;: {&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;Rotten_Tomatoes_Rating&quot;}, &quot;y&quot;: {&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;IMDB_Rating&quot;}}, &quot;selection&quot;: {&quot;Select&quot;: {&quot;type&quot;: &quot;single&quot;, &quot;fields&quot;: [&quot;Major_Genre&quot;, &quot;MPAA_Rating&quot;], &quot;init&quot;: {&quot;Major_Genre&quot;: &quot;Drama&quot;, &quot;MPAA_Rating&quot;: &quot;R&quot;}, &quot;bind&quot;: {&quot;Major_Genre&quot;: {&quot;input&quot;: &quot;select&quot;, &quot;options&quot;: [&quot;Action&quot;, &quot;Adventure&quot;, &quot;Black Comedy&quot;, &quot;Comedy&quot;, &quot;Concert/Performance&quot;, &quot;Documentary&quot;, &quot;Drama&quot;, &quot;Horror&quot;, &quot;Musical&quot;, &quot;Romantic Comedy&quot;, &quot;Thriller/Suspense&quot;, &quot;Western&quot;]}, &quot;MPAA_Rating&quot;: {&quot;input&quot;: &quot;radio&quot;, &quot;options&quot;: [&quot;G&quot;, &quot;PG&quot;, &quot;PG-13&quot;, &quot;R&quot;, &quot;NC-17&quot;, &quot;Not Rated&quot;]}}}}, &quot;$schema&quot;: &quot;https://vega.github.io/schema/vega-lite/v4.0.2.json&quot;}, {&quot;mode&quot;: &quot;vega-lite&quot;});
&lt;/script&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Example-2:-Tooltips&quot;&gt;Example 2: Tooltips&lt;a class=&quot;anchor-link&quot; href=&quot;#Example-2:-Tooltips&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Chart&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mark_circle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_selection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;selection_interval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bind&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;scales&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encodings&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;x&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Rotten_Tomatoes_Rating:Q&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;IMDB_Rating:Q&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Axis&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;minExtent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)),&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# use min extent to stabilize axis title placement&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tooltip&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Title:N&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Release_Date:N&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;IMDB_Rating:Q&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Rotten_Tomatoes_Rating:Q&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;properties&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;600&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;400&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;

&lt;div id=&quot;altair-viz-c022b476f4fb482ca6f609bf6ed082d2&quot;&gt;&lt;/div&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
  (function(spec, embedOpt){
    const outputDiv = document.getElementById(&quot;altair-viz-c022b476f4fb482ca6f609bf6ed082d2&quot;);
    const paths = {
      &quot;vega&quot;: &quot;https://cdn.jsdelivr.net/npm//vega@5?noext&quot;,
      &quot;vega-lib&quot;: &quot;https://cdn.jsdelivr.net/npm//vega-lib?noext&quot;,
      &quot;vega-lite&quot;: &quot;https://cdn.jsdelivr.net/npm//vega-lite@4.0.2?noext&quot;,
      &quot;vega-embed&quot;: &quot;https://cdn.jsdelivr.net/npm//vega-embed@6?noext&quot;,
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () =&gt; resolve(paths[lib]);
        s.onerror = () =&gt; reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName(&quot;head&quot;)[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `&lt;div class=&quot;error&quot; style=&quot;color:red;&quot;&gt;${err}&lt;/div&gt;`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err =&gt; showError(`Javascript Error: ${err.message}&lt;br&gt;This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === &quot;function&quot; &amp;&amp; define.amd) {
      requirejs.config({paths});
      require([&quot;vega-embed&quot;], displayChart, err =&gt; showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === &quot;function&quot;) {
      displayChart(vegaEmbed);
    } else {
      loadScript(&quot;vega&quot;)
        .then(() =&gt; loadScript(&quot;vega-lite&quot;))
        .then(() =&gt; loadScript(&quot;vega-embed&quot;))
        .catch(showError)
        .then(() =&gt; displayChart(vegaEmbed));
    }
  })({&quot;config&quot;: {&quot;view&quot;: {&quot;continuousWidth&quot;: 400, &quot;continuousHeight&quot;: 300}}, &quot;data&quot;: {&quot;url&quot;: &quot;https://vega.github.io/vega-datasets/data/movies.json&quot;}, &quot;mark&quot;: &quot;circle&quot;, &quot;encoding&quot;: {&quot;tooltip&quot;: [{&quot;type&quot;: &quot;nominal&quot;, &quot;field&quot;: &quot;Title&quot;}, {&quot;type&quot;: &quot;nominal&quot;, &quot;field&quot;: &quot;Release_Date&quot;}, {&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;IMDB_Rating&quot;}, {&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;Rotten_Tomatoes_Rating&quot;}], &quot;x&quot;: {&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;Rotten_Tomatoes_Rating&quot;}, &quot;y&quot;: {&quot;type&quot;: &quot;quantitative&quot;, &quot;axis&quot;: {&quot;minExtent&quot;: 30}, &quot;field&quot;: &quot;IMDB_Rating&quot;}}, &quot;height&quot;: 400, &quot;selection&quot;: {&quot;selector001&quot;: {&quot;type&quot;: &quot;interval&quot;, &quot;bind&quot;: &quot;scales&quot;, &quot;encodings&quot;: [&quot;x&quot;]}}, &quot;width&quot;: 600, &quot;$schema&quot;: &quot;https://vega.github.io/schema/vega-lite/v4.0.2.json&quot;}, {&quot;mode&quot;: &quot;vega-lite&quot;});
&lt;/script&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Example-3:-More-Tooltips&quot;&gt;Example 3: More Tooltips&lt;a class=&quot;anchor-link&quot; href=&quot;#Example-3:-More-Tooltips&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# select a point for which to provide details-on-demand&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;label&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;selection_single&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;encodings&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;x&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# limit selection to x-axis value&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mouseover&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# select on mouseover events&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;nearest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;# select data point nearest the cursor&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;empty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;none&amp;#39;&lt;/span&gt;     &lt;span class=&quot;c1&quot;&gt;# empty selection includes no data points&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# define our base line chart of stock prices&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;base&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Chart&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mark_line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;date:T&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;price:Q&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scale&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Scale&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;log&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)),&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Color&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;symbol:N&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# base line chart&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# add a rule mark to serve as a guide line&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Chart&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mark_rule&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;#aaa&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;date:T&amp;#39;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform_filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# add circle marks for selected time points, hide unselected points&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mark_circle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;opacity&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;condition&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_selection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# add white stroked text to provide a legible background for labels&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mark_text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;align&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;left&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stroke&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;white&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;strokeWidth&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;price:Q&amp;#39;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform_filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# add text labels for stock prices&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mark_text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;align&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;left&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;price:Q&amp;#39;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform_filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stocks&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;properties&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;700&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;400&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;

&lt;div id=&quot;altair-viz-9283d3681fd24aafa3d1e2f9ad193ecf&quot;&gt;&lt;/div&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
  (function(spec, embedOpt){
    const outputDiv = document.getElementById(&quot;altair-viz-9283d3681fd24aafa3d1e2f9ad193ecf&quot;);
    const paths = {
      &quot;vega&quot;: &quot;https://cdn.jsdelivr.net/npm//vega@5?noext&quot;,
      &quot;vega-lib&quot;: &quot;https://cdn.jsdelivr.net/npm//vega-lib?noext&quot;,
      &quot;vega-lite&quot;: &quot;https://cdn.jsdelivr.net/npm//vega-lite@4.0.2?noext&quot;,
      &quot;vega-embed&quot;: &quot;https://cdn.jsdelivr.net/npm//vega-embed@6?noext&quot;,
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () =&gt; resolve(paths[lib]);
        s.onerror = () =&gt; reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName(&quot;head&quot;)[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `&lt;div class=&quot;error&quot; style=&quot;color:red;&quot;&gt;${err}&lt;/div&gt;`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err =&gt; showError(`Javascript Error: ${err.message}&lt;br&gt;This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === &quot;function&quot; &amp;&amp; define.amd) {
      requirejs.config({paths});
      require([&quot;vega-embed&quot;], displayChart, err =&gt; showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === &quot;function&quot;) {
      displayChart(vegaEmbed);
    } else {
      loadScript(&quot;vega&quot;)
        .then(() =&gt; loadScript(&quot;vega-lite&quot;))
        .then(() =&gt; loadScript(&quot;vega-embed&quot;))
        .catch(showError)
        .then(() =&gt; displayChart(vegaEmbed));
    }
  })({&quot;config&quot;: {&quot;view&quot;: {&quot;continuousWidth&quot;: 400, &quot;continuousHeight&quot;: 300}}, &quot;layer&quot;: [{&quot;mark&quot;: &quot;line&quot;, &quot;encoding&quot;: {&quot;color&quot;: {&quot;type&quot;: &quot;nominal&quot;, &quot;field&quot;: &quot;symbol&quot;}, &quot;x&quot;: {&quot;type&quot;: &quot;temporal&quot;, &quot;field&quot;: &quot;date&quot;}, &quot;y&quot;: {&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;price&quot;, &quot;scale&quot;: {&quot;type&quot;: &quot;log&quot;}}}}, {&quot;mark&quot;: {&quot;type&quot;: &quot;rule&quot;, &quot;color&quot;: &quot;#aaa&quot;}, &quot;encoding&quot;: {&quot;x&quot;: {&quot;type&quot;: &quot;temporal&quot;, &quot;field&quot;: &quot;date&quot;}}, &quot;transform&quot;: [{&quot;filter&quot;: {&quot;selection&quot;: &quot;selector002&quot;}}]}, {&quot;mark&quot;: &quot;circle&quot;, &quot;encoding&quot;: {&quot;color&quot;: {&quot;type&quot;: &quot;nominal&quot;, &quot;field&quot;: &quot;symbol&quot;}, &quot;opacity&quot;: {&quot;condition&quot;: {&quot;value&quot;: 1, &quot;selection&quot;: &quot;selector002&quot;}, &quot;value&quot;: 0}, &quot;x&quot;: {&quot;type&quot;: &quot;temporal&quot;, &quot;field&quot;: &quot;date&quot;}, &quot;y&quot;: {&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;price&quot;, &quot;scale&quot;: {&quot;type&quot;: &quot;log&quot;}}}, &quot;selection&quot;: {&quot;selector002&quot;: {&quot;type&quot;: &quot;single&quot;, &quot;encodings&quot;: [&quot;x&quot;], &quot;on&quot;: &quot;mouseover&quot;, &quot;nearest&quot;: true, &quot;empty&quot;: &quot;none&quot;}}}, {&quot;mark&quot;: {&quot;type&quot;: &quot;text&quot;, &quot;align&quot;: &quot;left&quot;, &quot;dx&quot;: 5, &quot;dy&quot;: -5, &quot;stroke&quot;: &quot;white&quot;, &quot;strokeWidth&quot;: 2}, &quot;encoding&quot;: {&quot;color&quot;: {&quot;type&quot;: &quot;nominal&quot;, &quot;field&quot;: &quot;symbol&quot;}, &quot;text&quot;: {&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;price&quot;}, &quot;x&quot;: {&quot;type&quot;: &quot;temporal&quot;, &quot;field&quot;: &quot;date&quot;}, &quot;y&quot;: {&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;price&quot;, &quot;scale&quot;: {&quot;type&quot;: &quot;log&quot;}}}, &quot;transform&quot;: [{&quot;filter&quot;: {&quot;selection&quot;: &quot;selector002&quot;}}]}, {&quot;mark&quot;: {&quot;type&quot;: &quot;text&quot;, &quot;align&quot;: &quot;left&quot;, &quot;dx&quot;: 5, &quot;dy&quot;: -5}, &quot;encoding&quot;: {&quot;color&quot;: {&quot;type&quot;: &quot;nominal&quot;, &quot;field&quot;: &quot;symbol&quot;}, &quot;text&quot;: {&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;price&quot;}, &quot;x&quot;: {&quot;type&quot;: &quot;temporal&quot;, &quot;field&quot;: &quot;date&quot;}, &quot;y&quot;: {&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;price&quot;, &quot;scale&quot;: {&quot;type&quot;: &quot;log&quot;}}}, &quot;transform&quot;: [{&quot;filter&quot;: {&quot;selection&quot;: &quot;selector002&quot;}}]}], &quot;data&quot;: {&quot;url&quot;: &quot;https://vega.github.io/vega-datasets/data/stocks.csv&quot;}, &quot;height&quot;: 400, &quot;width&quot;: 700, &quot;$schema&quot;: &quot;https://vega.github.io/schema/vega-lite/v4.0.2.json&quot;}, {&quot;mode&quot;: &quot;vega-lite&quot;});
&lt;/script&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Data-Tables&quot;&gt;Data Tables&lt;a class=&quot;anchor-link&quot; href=&quot;#Data-Tables&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;You can display tables per the usual way in your blog:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movies&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;https://vega.github.io/vega-datasets/data/movies.json&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read_json&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;movies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# display table with pandas&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Title&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Worldwide_Gross&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;Production_Budget&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Distributor&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;MPAA_Rating&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;IMDB_Rating&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Rotten_Tomatoes_Rating&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Title&lt;/th&gt;
      &lt;th&gt;Worldwide_Gross&lt;/th&gt;
      &lt;th&gt;Production_Budget&lt;/th&gt;
      &lt;th&gt;Distributor&lt;/th&gt;
      &lt;th&gt;MPAA_Rating&lt;/th&gt;
      &lt;th&gt;IMDB_Rating&lt;/th&gt;
      &lt;th&gt;Rotten_Tomatoes_Rating&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;The Land Girls&lt;/td&gt;
      &lt;td&gt;146083.0&lt;/td&gt;
      &lt;td&gt;8000000.0&lt;/td&gt;
      &lt;td&gt;Gramercy&lt;/td&gt;
      &lt;td&gt;R&lt;/td&gt;
      &lt;td&gt;6.1&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;First Love, Last Rites&lt;/td&gt;
      &lt;td&gt;10876.0&lt;/td&gt;
      &lt;td&gt;300000.0&lt;/td&gt;
      &lt;td&gt;Strand&lt;/td&gt;
      &lt;td&gt;R&lt;/td&gt;
      &lt;td&gt;6.9&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;I Married a Strange Person&lt;/td&gt;
      &lt;td&gt;203134.0&lt;/td&gt;
      &lt;td&gt;250000.0&lt;/td&gt;
      &lt;td&gt;Lionsgate&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;6.8&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;Let's Talk About Sex&lt;/td&gt;
      &lt;td&gt;373615.0&lt;/td&gt;
      &lt;td&gt;300000.0&lt;/td&gt;
      &lt;td&gt;Fine Line&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;13.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;Slam&lt;/td&gt;
      &lt;td&gt;1087521.0&lt;/td&gt;
      &lt;td&gt;1000000.0&lt;/td&gt;
      &lt;td&gt;Trimark&lt;/td&gt;
      &lt;td&gt;R&lt;/td&gt;
      &lt;td&gt;3.4&lt;/td&gt;
      &lt;td&gt;62.0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Images&quot;&gt;Images&lt;a class=&quot;anchor-link&quot; href=&quot;#Images&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;h3 id=&quot;Local-Images&quot;&gt;Local Images&lt;a class=&quot;anchor-link&quot; href=&quot;#Local-Images&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;You can reference local images and they will be copied and rendered on your blog automatically.  You can include these with the following markdown syntax:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;![](my_icons/fastai_logo.png)&lt;/code&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/gsoc/images/copied_from_nb/my_icons/fastai_logo.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Remote-Images&quot;&gt;Remote Images&lt;a class=&quot;anchor-link&quot; href=&quot;#Remote-Images&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Remote images can be included with the following markdown syntax:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;![](https://image.flaticon.com/icons/svg/36/36686.svg)&lt;/code&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;https://image.flaticon.com/icons/svg/36/36686.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Animated-Gifs&quot;&gt;Animated Gifs&lt;a class=&quot;anchor-link&quot; href=&quot;#Animated-Gifs&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Animated Gifs work, too!&lt;/p&gt;
&lt;p&gt;&lt;code&gt;![](https://upload.wikimedia.org/wikipedia/commons/7/71/ChessPawnSpecialMoves.gif)&lt;/code&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;https://upload.wikimedia.org/wikipedia/commons/7/71/ChessPawnSpecialMoves.gif&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Captions&quot;&gt;Captions&lt;a class=&quot;anchor-link&quot; href=&quot;#Captions&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;You can include captions with markdown images like this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;![](https://www.fast.ai/images/fastai_paper/show_batch.png &quot;Credit: https://www.fast.ai/2020/02/13/fastai-A-Layered-API-for-Deep-Learning/&quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://www.fast.ai/images/fastai_paper/show_batch.png&quot; alt=&quot;&quot; title=&quot;Credit: https://www.fast.ai/2020/02/13/fastai-A-Layered-API-for-Deep-Learning/&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Other-Elements&quot;&gt;Other Elements&lt;a class=&quot;anchor-link&quot; href=&quot;#Other-Elements&quot;&gt; &lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;GitHub-Flavored-Emojis&quot;&gt;GitHub Flavored Emojis&lt;a class=&quot;anchor-link&quot; href=&quot;#GitHub-Flavored-Emojis&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Typing &lt;code&gt;I give this post two :+1:!&lt;/code&gt; will render this:&lt;/p&gt;
&lt;p&gt;I give this post two :+1:!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Tweetcards&quot;&gt;Tweetcards&lt;a class=&quot;anchor-link&quot; href=&quot;#Tweetcards&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Typing &lt;code&gt;&amp;gt; twitter: https://twitter.com/jakevdp/status/1204765621767901185?s=20&lt;/code&gt; will render this:

&lt;center&gt;
    &lt;div class=&quot;jekyll-twitter-plugin&quot;&gt;&lt;blockquote class=&quot;twitter-tweet&quot;&gt;&lt;p lang=&quot;en&quot; dir=&quot;ltr&quot;&gt;Altair 4.0 is released! &lt;a href=&quot;https://t.co/PCyrIOTcvv&quot;&gt;https://t.co/PCyrIOTcvv&lt;/a&gt;&lt;br /&gt;Try it with:&lt;br /&gt;&lt;br /&gt;  pip install -U altair&lt;br /&gt;&lt;br /&gt;The full list of changes is at &lt;a href=&quot;https://t.co/roXmzcsT58&quot;&gt;https://t.co/roXmzcsT58&lt;/a&gt; ...read on for some highlights. &lt;a href=&quot;https://t.co/vWJ0ZveKbZ&quot;&gt;pic.twitter.com/vWJ0ZveKbZ&lt;/a&gt;&lt;/p&gt;&amp;mdash; Jake VanderPlas (@jakevdp) &lt;a href=&quot;https://twitter.com/jakevdp/status/1204765621767901185?ref_src=twsrc%5Etfw&quot;&gt;December 11, 2019&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async=&quot;&quot; src=&quot;https://platform.twitter.com/widgets.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt;
&lt;/div&gt;
&lt;/center&gt;
&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Youtube-Videos&quot;&gt;Youtube Videos&lt;a class=&quot;anchor-link&quot; href=&quot;#Youtube-Videos&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Typing &lt;code&gt;&amp;gt; youtube: https://youtu.be/XfoYk_Z5AkI&lt;/code&gt; will render this:

&lt;center&gt;
    &lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/XfoYk_Z5AkI&quot; frameborder=&quot;0&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;
&lt;/center&gt;
&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Boxes-/-Callouts&quot;&gt;Boxes / Callouts&lt;a class=&quot;anchor-link&quot; href=&quot;#Boxes-/-Callouts&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Typing &lt;code&gt;&amp;gt; Warning: There will be no second warning!&lt;/code&gt; will render this:
&lt;div class=&quot;flash flash-error&quot;&gt;
    &lt;svg class=&quot;octicon octicon-alert&quot; viewBox=&quot;0 0 16 16&quot; version=&quot;1.1&quot; width=&quot;16&quot; height=&quot;16&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 000 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 00.01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;
    &lt;strong&gt;Warning: &lt;/strong&gt;There will be no second warning!
&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;Typing &lt;code&gt;&amp;gt; Important: Pay attention! It's important.&lt;/code&gt; will render this:
&lt;div class=&quot;flash flash-warn&quot;&gt;
    &lt;svg class=&quot;octicon octicon-zap&quot; viewBox=&quot;0 0 10 16&quot; version=&quot;1.1&quot; width=&quot;10&quot; height=&quot;16&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M10 7H6l3-7-9 9h4l-3 7 9-9z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;
    &lt;strong&gt;Important: &lt;/strong&gt;Pay attention! It&amp;#8217;s important.
&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;Typing &lt;code&gt;&amp;gt; Tip: This is my tip.&lt;/code&gt; will render this:
&lt;div class=&quot;flash flash-success&quot;&gt;
    &lt;svg class=&quot;octicon octicon-checklist&quot; viewBox=&quot;0 0 16 16&quot; version=&quot;1.1&quot; width=&quot;16&quot; height=&quot;16&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M16 8.5l-6 6-3-3L8.5 10l1.5 1.5L14.5 7 16 8.5zM5.7 12.2l.8.8H2c-.55 0-1-.45-1-1V3c0-.55.45-1 1-1h7c.55 0 1 .45 1 1v6.5l-.8-.8c-.39-.39-1.03-.39-1.42 0L5.7 10.8a.996.996 0 000 1.41v-.01zM4 4h5V3H4v1zm0 2h5V5H4v1zm0 2h3V7H4v1zM3 9H2v1h1V9zm0-2H2v1h1V7zm0-2H2v1h1V5zm0-2H2v1h1V3z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;
    &lt;strong&gt;Tip: &lt;/strong&gt;This is my tip.
&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;Typing &lt;code&gt;&amp;gt; Note: Take note of this.&lt;/code&gt; will render this:
&lt;div class=&quot;flash&quot;&gt;
    &lt;svg class=&quot;octicon octicon-info&quot; viewBox=&quot;0 0 14 16&quot; version=&quot;1.1&quot; width=&quot;14&quot; height=&quot;16&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M6.3 5.69a.942.942 0 01-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 01-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;
    &lt;strong&gt;Note: &lt;/strong&gt;Take note of this.
&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;Typing &lt;code&gt;&amp;gt; Note: A doc link to [an example website: fast.ai](https://www.fast.ai/) should also work fine.&lt;/code&gt; will render in the docs:
&lt;div class=&quot;flash&quot;&gt;
    &lt;svg class=&quot;octicon octicon-info octicon octicon-info&quot; viewBox=&quot;0 0 14 16&quot; version=&quot;1.1&quot; width=&quot;14&quot; height=&quot;16&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M6.3 5.69a.942.942 0 01-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 01-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;
    &lt;strong&gt;Note: &lt;/strong&gt;A doc link to &lt;a href=&quot;https://www.fast.ai/&quot;&gt;an example website: fast.ai&lt;/a&gt; should also work fine.
&lt;/div&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Footnotes&quot;&gt;Footnotes&lt;a class=&quot;anchor-link&quot; href=&quot;#Footnotes&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;You can have footnotes in notebooks, however the syntax is different compared to markdown documents. &lt;a href=&quot;https://github.com/fastai/fastpages/blob/master/_fastpages_docs/NOTEBOOK_FOOTNOTES.md&quot;&gt;This guide provides more detail about this syntax&lt;/a&gt;, which looks like this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;For example, here is a footnote {% fn 1 %}.
And another {% fn 2 %}
{{ 'This is the footnote.' | fndetail: 1 }}
{{ 'This is the other footnote. You can even have a [link](www.github.com)!' | fndetail: 2 }}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;For example, here is a footnote &lt;sup id=&quot;fnref-1&quot; class=&quot;footnote-ref&quot;&gt;&lt;a href=&quot;#fn-1&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;p&gt;And another &lt;sup id=&quot;fnref-2&quot; class=&quot;footnote-ref&quot;&gt;&lt;a href=&quot;#fn-2&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;p&gt;&lt;div class=&quot;footnotes&quot;&gt;&lt;p id=&quot;fn-1&quot;&gt;1. This is the footnote.&lt;a href=&quot;#fnref-1&quot; class=&quot;footnote footnotes&quot;&gt;‚Ü©&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;footnotes&quot;&gt;&lt;p id=&quot;fn-2&quot;&gt;2. This is the other footnote. You can even have a &lt;a href=&quot;www.github.com&quot;&gt;link&lt;/a&gt;!&lt;a href=&quot;#fnref-2&quot; class=&quot;footnote footnotes&quot;&gt;‚Ü©&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://anirudhdagar.github.io/gsoc/images/chart-preview.png" /><media:content medium="image" url="https://anirudhdagar.github.io/gsoc/images/chart-preview.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry></feed>